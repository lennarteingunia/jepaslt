Activating mamba virtual environment.
Channels:
 - pytorch
 - nvidia
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done


==> WARNING: A newer version of conda exists. <==
    current version: 24.3.0
    latest version: 24.9.2

Please update conda by running

    $ conda update -n base -c conda-forge conda


Installing pip dependencies: ...working... Ran pip subprocess with arguments:
['/mnt/data/miniforge3/envs/jepaslt/bin/python', '-m', 'pip', 'install', '-U', '-r', '/mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt', '--exists-action=b']
Pip subprocess output:
Requirement already satisfied: opencv-python in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 1)) (4.10.0.84)
Requirement already satisfied: ffmpeg-python in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 2)) (0.2.0)
Requirement already satisfied: decord in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 3)) (0.6.0)
Requirement already satisfied: lightning in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2.4.0)
Requirement already satisfied: wandb in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (0.18.7)
Requirement already satisfied: loralib in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from -r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 7)) (0.1.2)
Requirement already satisfied: numpy>=1.21.2 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from opencv-python->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 1)) (2.1.3)
Requirement already satisfied: future in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from ffmpeg-python->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 2)) (1.0.0)
Requirement already satisfied: PyYAML<8.0,>=5.4 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (6.0.2)
Requirement already satisfied: fsspec<2026.0,>=2022.5.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2024.5.0)
Requirement already satisfied: lightning-utilities<2.0,>=0.10.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (0.11.7)
Requirement already satisfied: packaging<25.0,>=20.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (24.0)
Requirement already satisfied: torch<4.0,>=2.1.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2.5.1)
Requirement already satisfied: torchmetrics<3.0,>=0.7.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.4.2)
Requirement already satisfied: tqdm<6.0,>=4.57.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (4.66.4)
Requirement already satisfied: typing-extensions<6.0,>=4.4.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (4.11.0)
Requirement already satisfied: pytorch-lightning in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2.4.0)
Requirement already satisfied: bitsandbytes<1.0,>=0.42.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (0.44.0)
Requirement already satisfied: hydra-core<2.0,>=1.2.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (1.3.2)
Requirement already satisfied: jsonargparse<5.0,>=4.27.7 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from jsonargparse[signatures]<5.0,>=4.27.7; extra == "pytorch-extra"->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (4.32.1)
Requirement already satisfied: matplotlib<4.0,>3.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (3.9.2)
Requirement already satisfied: omegaconf<3.0,>=2.2.3 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (2.3.0)
Requirement already satisfied: rich<14.0,>=12.3.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (13.8.1)
Requirement already satisfied: tensorboardX<3.0,>=2.2 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (2.6.2.2)
Requirement already satisfied: click!=8.0.0,>=7.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (8.1.7)
Requirement already satisfied: docker-pycreds>=0.4.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (0.4.0)
Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (3.1.43)
Requirement already satisfied: platformdirs in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (4.3.6)
Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (5.28.2)
Requirement already satisfied: psutil>=5.0.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (6.0.0)
Requirement already satisfied: requests<3,>=2.0.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (2.32.2)
Requirement already satisfied: sentry-sdk>=2.0.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (2.14.0)
Requirement already satisfied: setproctitle in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (1.3.3)
Requirement already satisfied: setuptools in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (70.0.0)
Requirement already satisfied: six>=1.4.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from docker-pycreds>=0.4.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (1.16.0)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (3.10.5)
Requirement already satisfied: gitdb<5,>=4.0.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (4.0.11)
Requirement already satisfied: antlr4-python3-runtime==4.9.* in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from hydra-core<2.0,>=1.2.0->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (4.9.3)
Requirement already satisfied: docstring-parser>=0.15 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from jsonargparse[signatures]<5.0,>=4.27.7; extra == "pytorch-extra"->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (0.16)
Requirement already satisfied: typeshed-client>=2.1.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from jsonargparse[signatures]<5.0,>=4.27.7; extra == "pytorch-extra"->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (2.7.0)
Requirement already satisfied: contourpy>=1.0.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (1.3.0)
Requirement already satisfied: cycler>=0.10 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (4.54.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (1.4.7)
Requirement already satisfied: pillow>=8 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (9.4.0)
Requirement already satisfied: pyparsing>=2.3.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (3.1.4)
Requirement already satisfied: python-dateutil>=2.7 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from matplotlib<4.0,>3.1->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (2.9.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (2.2.1)
Requirement already satisfied: certifi>=2017.4.17 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (2024.8.30)
Requirement already satisfied: markdown-it-py>=2.2.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from rich<14.0,>=12.3.0->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from rich<14.0,>=12.3.0->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (2.18.0)
Requirement already satisfied: filelock in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (3.14.0)
Requirement already satisfied: networkx in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (3.2.1)
Requirement already satisfied: jinja2 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from sympy==1.13.1->torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.3.0)
Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.3.1)
Requirement already satisfied: attrs>=17.3.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (24.2.0)
Requirement already satisfied: frozenlist>=1.1.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.4.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (6.1.0)
Requirement already satisfied: yarl<2.0,>=1.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (1.12.1)
Requirement already satisfied: async-timeout<5.0,>=4.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2026.0,>=2022.5.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (4.0.3)
Requirement already satisfied: smmap<6,>=3.0.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 6)) (5.0.1)
Requirement already satisfied: mdurl~=0.1 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich<14.0,>=12.3.0->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (0.1.2)
Requirement already satisfied: importlib-resources>=1.4.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from typeshed-client>=2.1.0->jsonargparse[signatures]<5.0,>=4.27.7; extra == "pytorch-extra"->lightning[pytorch-extra]->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 5)) (6.4.5)
Requirement already satisfied: MarkupSafe>=2.0 in /mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages (from jinja2->torch<4.0,>=2.1.0->lightning->-r /mnt/slurm/lennart/jepaslt/condaenv.lhxh6zr_.requirements.txt (line 4)) (2.1.5)

done
#
# To activate this environment, use
#
#     $ conda activate jepaslt
#
# To deactivate an active environment, use
#
#     $ conda deactivate

Collecting pysha3
  Using cached pysha3-1.0.2-cp310-cp310-linux_x86_64.whl
Installing collected packages: pysha3
Successfully installed pysha3-1.0.2
INFO:root:called-params /mnt/slurm/lennart/jepaslt/configs/evals/vith16_384_ravdess_split_1_pretrained_full_video.yaml
INFO:root:loaded params...
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/1_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_1'},
    'tag': 'ravdess_1-16x8x3',
    'tasks_per_node': 3}
INFO:root:Running... (rank: 0/3)
INFO:root:Running evaluation: pretrained_full_video_classification
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/1_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_1'},
    'tag': 'ravdess_1-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 1/3
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/1_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_1'},
    'tag': 'ravdess_1-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 2/3
INFO:root:Initialized (rank/world-size) 0/3
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:Indexed a total number of 600 videos containing 27653 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 769
INFO:root:Indexed a total number of 600 videos containing 27653 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 769
INFO:root:Indexed a total number of 600 videos containing 27653 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 769
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
INFO:root:rank 0/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, nan, 1., nan], device='cuda:0')
INFO:root:rank 1/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, nan, 1., nan], device='cuda:0')
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 2/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, nan, 1., nan], device='cuda:0')
INFO:root:rank 0/iteration 20: Current Top 1 Accuracy: 0.44841268658638, Current Top 1 PC Accuracy: tensor([   nan,    nan,    nan,    nan, 0.0000, 0.5294, 0.8911, 1.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 20: Current Top 1 Accuracy: 0.4246031641960144, Current Top 1 PC Accuracy: tensor([   nan,    nan, 0.0000,    nan, 0.0000, 0.4571, 0.8900, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 20: Current Top 1 Accuracy: 0.420634925365448, Current Top 1 PC Accuracy: tensor([   nan,    nan,    nan,    nan, 0.0000, 0.4722, 0.8958, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 40: Current Top 1 Accuracy: 0.5813007950782776, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 1.0000, 1.0000, 0.0914, 0.6630, 0.9018, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 40: Current Top 1 Accuracy: 0.5609756112098694, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 1.0000, 1.0000, 0.0884, 0.6105, 0.9108, 1.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 40: Current Top 1 Accuracy: 0.577235758304596, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9412, 1.0000, 0.0983, 0.6316, 0.9018, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 60: Current Top 1 Accuracy: 0.6297814249992371, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9211, 1.0000, 0.2857, 0.6289, 0.8909, 0.8571],
       device='cuda:0')
INFO:root:rank 2/iteration 60: Current Top 1 Accuracy: 0.6161202192306519, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9467, 1.0000, 0.2809, 0.5743, 0.8827, 1.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 60: Current Top 1 Accuracy: 0.6297814249992371, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9315, 1.0000, 0.2897, 0.6000, 0.8802, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 80: Current Top 1 Accuracy: 0.6183127760887146, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9174, 0.9828, 0.3514, 0.5179, 0.7772, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 80: Current Top 1 Accuracy: 0.6286008358001709, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9113, 1.0000, 0.3602, 0.5545, 0.7696, 0.8571],
       device='cuda:0')
INFO:root:rank 1/iteration 80: Current Top 1 Accuracy: 0.6275720000267029, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9160, 1.0000, 0.3586, 0.5505, 0.7656, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 100: Current Top 1 Accuracy: 0.6542904376983643, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9277, 1.0000, 0.4367, 0.5214, 0.7462, 0.8571],
       device='cuda:0')
INFO:root:rank 2/iteration 100: Current Top 1 Accuracy: 0.6526402831077576, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9325, 0.9878, 0.4356, 0.4874, 0.7448, 1.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 100: Current Top 1 Accuracy: 0.6575907468795776, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9375, 1.0000, 0.4393, 0.5128, 0.7350, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 120: Current Top 1 Accuracy: 0.6611570119857788, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9336, 1.0000, 0.4683, 0.4803, 0.6934, 0.8571],
       device='cuda:0')
INFO:root:rank 2/iteration 120: Current Top 1 Accuracy: 0.6563360691070557, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9286, 0.9909, 0.4659, 0.4567, 0.6842, 0.7500],
       device='cuda:0')
INFO:root:rank 1/iteration 120: Current Top 1 Accuracy: 0.6625344157218933, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9279, 0.9910, 0.4731, 0.4762, 0.6806, 1.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 140: Current Top 1 Accuracy: 0.6459810733795166, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9215, 1.0000, 0.4309, 0.4898, 0.7099, 0.8889],
       device='cuda:0')
INFO:root:rank 1/iteration 140: Current Top 1 Accuracy: 0.6495271921157837, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9129, 0.9917, 0.4342, 0.4830, 0.7088, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 140: Current Top 1 Accuracy: 0.6436170339584351, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9177, 0.9915, 0.4288, 0.4765, 0.7137, 0.8333],
       device='cuda:0')
INFO:root:rank 0/iteration 160: Current Top 1 Accuracy: 0.6293995976448059, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9215, 1.0000, 0.3867, 0.5200, 0.7597, 0.9091],
       device='cuda:0')
INFO:root:rank 1/iteration 160: Current Top 1 Accuracy: 0.6330227851867676, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9129, 0.9917, 0.3909, 0.5049, 0.7618, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 160: Current Top 1 Accuracy: 0.6262940168380737, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9177, 0.9915, 0.3848, 0.5049, 0.7627, 0.8571],
       device='cuda:0')
INFO:root:rank 0/iteration 180: Current Top 1 Accuracy: 0.660681426525116, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9249, 1.0000, 0.4165, 0.5409, 0.7610, 0.9091],
       device='cuda:0')
INFO:root:rank 1/iteration 180: Current Top 1 Accuracy: 0.6643646359443665, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9212, 0.9938, 0.4194, 0.5315, 0.7630, 1.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 180: Current Top 1 Accuracy: 0.6583793759346008, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9283, 0.9937, 0.4142, 0.5291, 0.7619, 0.8571],
       device='cuda:0')
INFO:root:rank 0/iteration 200: Current Top 1 Accuracy: 0.6894693374633789, Current Top 1 PC Accuracy: tensor([0.0000, 0.9890, 0.9364, 1.0000, 0.4558, 0.5409, 0.7494, 0.7692],
       device='cuda:0')
INFO:root:rank 1/iteration 200: Current Top 1 Accuracy: 0.6923714876174927, Current Top 1 PC Accuracy: tensor([0.0000, 0.9930, 0.9329, 0.9955, 0.4587, 0.5315, 0.7494, 0.7500],
       device='cuda:0')
INFO:root:rank 2/iteration 200: Current Top 1 Accuracy: 0.686981737613678, Current Top 1 PC Accuracy: tensor([0.0000, 0.9890, 0.9395, 0.9954, 0.4548, 0.5291, 0.7461, 0.8571],
       device='cuda:0')
INFO:root:rank 0/iteration 220: Current Top 1 Accuracy: 0.6938160061836243, Current Top 1 PC Accuracy: tensor([0.7368, 0.9895, 0.9392, 0.9016, 0.4580, 0.5426, 0.7815, 0.8667],
       device='cuda:0')
INFO:root:rank 1/iteration 220: Current Top 1 Accuracy: 0.6945701241493225, Current Top 1 PC Accuracy: tensor([0.6667, 0.9933, 0.9359, 0.9046, 0.4585, 0.5315, 0.7756, 0.9048],
       device='cuda:0')
INFO:root:rank 2/iteration 220: Current Top 1 Accuracy: 0.6892911195755005, Current Top 1 PC Accuracy: tensor([0.6667, 0.9895, 0.9421, 0.9051, 0.4563, 0.5251, 0.7716, 0.9130],
       device='cuda:0')
INFO:root:rank 0/iteration 240: Current Top 1 Accuracy: 0.7012448310852051, Current Top 1 PC Accuracy: tensor([0.9153, 0.9895, 0.9392, 0.8481, 0.4530, 0.5710, 0.8004, 0.9310],
       device='cuda:0')
INFO:root:rank 1/iteration 240: Current Top 1 Accuracy: 0.7012448310852051, Current Top 1 PC Accuracy: tensor([0.8852, 0.9933, 0.9333, 0.8434, 0.4539, 0.5635, 0.7978, 0.9375],
       device='cuda:0')
INFO:root:rank 2/iteration 240: Current Top 1 Accuracy: 0.6967496275901794, Current Top 1 PC Accuracy: tensor([0.8852, 0.9895, 0.9370, 0.8513, 0.4522, 0.5609, 0.7898, 0.9574],
       device='cuda:0')
INFO:root:rank 0/iteration 260: Current Top 1 Accuracy: 0.702426552772522, Current Top 1 PC Accuracy: tensor([0.9419, 0.9895, 0.9189, 0.7842, 0.4437, 0.5933, 0.8245, 0.9367],
       device='cuda:0')
INFO:root:rank 1/iteration 260: Current Top 1 Accuracy: 0.7021072506904602, Current Top 1 PC Accuracy: tensor([0.9213, 0.9933, 0.9180, 0.7822, 0.4431, 0.5831, 0.8224, 0.9552],
       device='cuda:0')
INFO:root:rank 2/iteration 260: Current Top 1 Accuracy: 0.6979565620422363, Current Top 1 PC Accuracy: tensor([0.9205, 0.9895, 0.9169, 0.7869, 0.4434, 0.5782, 0.8146, 0.9565],
       device='cuda:0')
INFO:root:rank 0/iteration 280: Current Top 1 Accuracy: 0.7037366628646851, Current Top 1 PC Accuracy: tensor([0.9533, 0.9895, 0.8971, 0.7633, 0.4398, 0.6070, 0.8254, 0.9400],
       device='cuda:0')
INFO:root:rank 1/iteration 280: Current Top 1 Accuracy: 0.7031435370445251, Current Top 1 PC Accuracy: tensor([0.9375, 0.9933, 0.8984, 0.7453, 0.4392, 0.6010, 0.8243, 0.9659],
       device='cuda:0')
INFO:root:rank 2/iteration 280: Current Top 1 Accuracy: 0.6992882490158081, Current Top 1 PC Accuracy: tensor([0.9364, 0.9895, 0.8953, 0.7484, 0.4412, 0.5935, 0.8184, 0.9565],
       device='cuda:0')
INFO:root:rank 0/iteration 300: Current Top 1 Accuracy: 0.7195459604263306, Current Top 1 PC Accuracy: tensor([0.9554, 0.9879, 0.9038, 0.7800, 0.4702, 0.6056, 0.8261, 0.9464],
       device='cuda:0')
INFO:root:rank 1/iteration 300: Current Top 1 Accuracy: 0.7178848385810852, Current Top 1 PC Accuracy: tensor([0.9402, 0.9912, 0.9048, 0.7575, 0.4710, 0.6010, 0.8224, 0.9700],
       device='cuda:0')
INFO:root:rank 2/iteration 300: Current Top 1 Accuracy: 0.7148393988609314, Current Top 1 PC Accuracy: tensor([0.9386, 0.9880, 0.9038, 0.7619, 0.4726, 0.5935, 0.8179, 0.9612],
       device='cuda:0')
INFO:root:rank 0/iteration 320: Current Top 1 Accuracy: 0.7341640591621399, Current Top 1 PC Accuracy: tensor([0.9469, 0.9897, 0.9162, 0.8103, 0.4948, 0.6056, 0.8164, 0.9381],
       device='cuda:0')
INFO:root:rank 1/iteration 320: Current Top 1 Accuracy: 0.7313084006309509, Current Top 1 PC Accuracy: tensor([0.9244, 0.9925, 0.9172, 0.7867, 0.4943, 0.6010, 0.8106, 0.9510],
       device='cuda:0')
INFO:root:rank 2/iteration 320: Current Top 1 Accuracy: 0.7294911742210388, Current Top 1 PC Accuracy: tensor([0.9304, 0.9898, 0.9158, 0.7952, 0.4952, 0.5935, 0.8094, 0.9429],
       device='cuda:0')
INFO:root:rank 0/iteration 340: Current Top 1 Accuracy: 0.7377810478210449, Current Top 1 PC Accuracy: tensor([0.8629, 0.9860, 0.9227, 0.8213, 0.5224, 0.5699, 0.8164, 0.9381],
       device='cuda:0')
INFO:root:rank 1/iteration 340: Current Top 1 Accuracy: 0.7350928783416748, Current Top 1 PC Accuracy: tensor([0.8333, 0.9887, 0.9255, 0.7973, 0.5231, 0.5635, 0.8096, 0.9510],
       device='cuda:0')
INFO:root:rank 2/iteration 340: Current Top 1 Accuracy: 0.7326490879058838, Current Top 1 PC Accuracy: tensor([0.8295, 0.9838, 0.9244, 0.8055, 0.5228, 0.5582, 0.8083, 0.9429],
       device='cuda:0')
INFO:root:rank 0/iteration 360: Current Top 1 Accuracy: 0.7345337271690369, Current Top 1 PC Accuracy: tensor([0.7267, 0.9869, 0.9283, 0.8188, 0.5402, 0.5429, 0.8164, 0.9381],
       device='cuda:0')
INFO:root:rank 1/iteration 360: Current Top 1 Accuracy: 0.7324561476707458, Current Top 1 PC Accuracy: tensor([0.7229, 0.9895, 0.9310, 0.7973, 0.5402, 0.5343, 0.8096, 0.9510],
       device='cuda:0')
INFO:root:rank 2/iteration 360: Current Top 1 Accuracy: 0.7299168705940247, Current Top 1 PC Accuracy: tensor([0.7091, 0.9848, 0.9298, 0.8018, 0.5402, 0.5348, 0.8083, 0.9429],
       device='cuda:0')
INFO:root:rank 0/iteration 380: Current Top 1 Accuracy: 0.719597578048706, Current Top 1 PC Accuracy: tensor([0.7644, 0.9869, 0.9283, 0.7778, 0.5118, 0.5477, 0.8192, 0.9281],
       device='cuda:0')
INFO:root:rank 1/iteration 380: Current Top 1 Accuracy: 0.7180665135383606, Current Top 1 PC Accuracy: tensor([0.7653, 0.9895, 0.9310, 0.7585, 0.5097, 0.5474, 0.8115, 0.9600],
       device='cuda:0')
INFO:root:rank 2/iteration 380: Current Top 1 Accuracy: 0.7160980105400085, Current Top 1 PC Accuracy: tensor([0.7525, 0.9848, 0.9298, 0.7607, 0.5104, 0.5482, 0.8111, 0.9531],
       device='cuda:0')
INFO:root:rank 0/iteration 400: Current Top 1 Accuracy: 0.7082294225692749, Current Top 1 PC Accuracy: tensor([0.7867, 0.9869, 0.9267, 0.7241, 0.4907, 0.5552, 0.8224, 0.9396],
       device='cuda:0')
INFO:root:rank 1/iteration 400: Current Top 1 Accuracy: 0.7067747116088867, Current Top 1 PC Accuracy: tensor([0.7880, 0.9895, 0.9294, 0.7103, 0.4882, 0.5541, 0.8146, 0.9643],
       device='cuda:0')
INFO:root:rank 2/iteration 400: Current Top 1 Accuracy: 0.7046965956687927, Current Top 1 PC Accuracy: tensor([0.7752, 0.9848, 0.9250, 0.7106, 0.4890, 0.5543, 0.8151, 0.9643],
       device='cuda:0')
INFO:root:rank 0/iteration 420: Current Top 1 Accuracy: 0.7050672769546509, Current Top 1 PC Accuracy: tensor([0.7664, 0.9876, 0.9261, 0.7092, 0.4895, 0.5551, 0.8244, 0.9442],
       device='cuda:0')
INFO:root:rank 1/iteration 420: Current Top 1 Accuracy: 0.7038796544075012, Current Top 1 PC Accuracy: tensor([0.7661, 0.9880, 0.9303, 0.6969, 0.4868, 0.5583, 0.8163, 0.9624],
       device='cuda:0')
INFO:root:rank 2/iteration 420: Current Top 1 Accuracy: 0.7026920318603516, Current Top 1 PC Accuracy: tensor([0.7550, 0.9856, 0.9230, 0.6977, 0.4898, 0.5547, 0.8176, 0.9677],
       device='cuda:0')
INFO:root:rank 0/iteration 440: Current Top 1 Accuracy: 0.7031368017196655, Current Top 1 PC Accuracy: tensor([0.6926, 0.9881, 0.9293, 0.7099, 0.5074, 0.5305, 0.8244, 0.9442],
       device='cuda:0')
INFO:root:rank 1/iteration 440: Current Top 1 Accuracy: 0.7031368017196655, Current Top 1 PC Accuracy: tensor([0.7011, 0.9886, 0.9348, 0.6996, 0.5031, 0.5372, 0.8163, 0.9624],
       device='cuda:0')
INFO:root:rank 2/iteration 440: Current Top 1 Accuracy: 0.7023809552192688, Current Top 1 PC Accuracy: tensor([0.6963, 0.9864, 0.9280, 0.7011, 0.5075, 0.5300, 0.8176, 0.9677],
       device='cuda:0')
INFO:root:rank 0/iteration 460: Current Top 1 Accuracy: 0.7093275785446167, Current Top 1 PC Accuracy: tensor([0.7065, 0.9882, 0.9304, 0.7083, 0.5113, 0.5491, 0.8341, 0.9526],
       device='cuda:0')
INFO:root:rank 1/iteration 460: Current Top 1 Accuracy: 0.7093275785446167, Current Top 1 PC Accuracy: tensor([0.7264, 0.9887, 0.9359, 0.6974, 0.5067, 0.5540, 0.8262, 0.9680],
       device='cuda:0')
INFO:root:rank 2/iteration 460: Current Top 1 Accuracy: 0.7082429528236389, Current Top 1 PC Accuracy: tensor([0.7129, 0.9865, 0.9291, 0.7002, 0.5101, 0.5495, 0.8277, 0.9724],
       device='cuda:0')
INFO:root:rank 0/iteration 480: Current Top 1 Accuracy: 0.7127512097358704, Current Top 1 PC Accuracy: tensor([0.7341, 0.9882, 0.9304, 0.7002, 0.5082, 0.5534, 0.8500, 0.9486],
       device='cuda:0')
INFO:root:rank 1/iteration 480: Current Top 1 Accuracy: 0.7118849754333496, Current Top 1 PC Accuracy: tensor([0.7515, 0.9868, 0.9359, 0.6858, 0.5030, 0.5589, 0.8424, 0.9625],
       device='cuda:0')
INFO:root:rank 2/iteration 480: Current Top 1 Accuracy: 0.7113652229309082, Current Top 1 PC Accuracy: tensor([0.7398, 0.9865, 0.9291, 0.6916, 0.5067, 0.5543, 0.8439, 0.9623],
       device='cuda:0')
INFO:root:rank 0/iteration 500: Current Top 1 Accuracy: 0.7242182493209839, Current Top 1 PC Accuracy: tensor([0.7341, 0.9895, 0.9362, 0.7336, 0.5232, 0.5534, 0.8500, 0.9486],
       device='cuda:0')
INFO:root:rank 1/iteration 500: Current Top 1 Accuracy: 0.7228875756263733, Current Top 1 PC Accuracy: tensor([0.7515, 0.9882, 0.9374, 0.7185, 0.5182, 0.5589, 0.8424, 0.9625],
       device='cuda:0')
INFO:root:rank 2/iteration 500: Current Top 1 Accuracy: 0.7228875756263733, Current Top 1 PC Accuracy: tensor([0.7398, 0.9879, 0.9351, 0.7250, 0.5217, 0.5543, 0.8439, 0.9623],
       device='cuda:0')
INFO:root:rank 0/iteration 520: Current Top 1 Accuracy: 0.7343249917030334, Current Top 1 PC Accuracy: tensor([0.7341, 0.9906, 0.9387, 0.7516, 0.5433, 0.5534, 0.8500, 0.9486],
       device='cuda:0')
INFO:root:rank 1/iteration 520: Current Top 1 Accuracy: 0.732885479927063, Current Top 1 PC Accuracy: tensor([0.7493, 0.9894, 0.9387, 0.7381, 0.5385, 0.5589, 0.8424, 0.9585],
       device='cuda:0')
INFO:root:rank 2/iteration 520: Current Top 1 Accuracy: 0.7330453991889954, Current Top 1 PC Accuracy: tensor([0.7398, 0.9892, 0.9377, 0.7446, 0.5421, 0.5536, 0.8439, 0.9583],
       device='cuda:0')
INFO:root:rank 0/iteration 540: Current Top 1 Accuracy: 0.7435305118560791, Current Top 1 PC Accuracy: tensor([0.7341, 0.9913, 0.9396, 0.7729, 0.5602, 0.5534, 0.8500, 0.9486],
       device='cuda:0')
INFO:root:rank 1/iteration 540: Current Top 1 Accuracy: 0.7422981858253479, Current Top 1 PC Accuracy: tensor([0.7493, 0.9901, 0.9419, 0.7606, 0.5549, 0.5589, 0.8424, 0.9585],
       device='cuda:0')
INFO:root:rank 2/iteration 540: Current Top 1 Accuracy: 0.7424522638320923, Current Top 1 PC Accuracy: tensor([0.7398, 0.9899, 0.9400, 0.7666, 0.5589, 0.5536, 0.8439, 0.9583],
       device='cuda:0')
INFO:root:rank 0/iteration 560: Current Top 1 Accuracy: 0.7522281408309937, Current Top 1 PC Accuracy: tensor([0.7320, 0.9919, 0.9436, 0.7911, 0.5730, 0.5534, 0.8500, 0.9486],
       device='cuda:0')
INFO:root:rank 1/iteration 560: Current Top 1 Accuracy: 0.7507427334785461, Current Top 1 PC Accuracy: tensor([0.7449, 0.9909, 0.9458, 0.7782, 0.5687, 0.5582, 0.8424, 0.9545],
       device='cuda:0')
INFO:root:rank 2/iteration 560: Current Top 1 Accuracy: 0.751188337802887, Current Top 1 PC Accuracy: tensor([0.7398, 0.9907, 0.9440, 0.7849, 0.5720, 0.5536, 0.8439, 0.9544],
       device='cuda:0')
INFO:root:rank 0/iteration 580: Current Top 1 Accuracy: 0.7591795921325684, Current Top 1 PC Accuracy: tensor([0.7418, 0.9923, 0.9452, 0.7951, 0.5813, 0.5601, 0.8581, 0.9531],
       device='cuda:0')
INFO:root:rank 1/iteration 580: Current Top 1 Accuracy: 0.7573149800300598, Current Top 1 PC Accuracy: tensor([0.7500, 0.9912, 0.9473, 0.7824, 0.5761, 0.5649, 0.8508, 0.9586],
       device='cuda:0')
INFO:root:rank 2/iteration 580: Current Top 1 Accuracy: 0.7576018571853638, Current Top 1 PC Accuracy: tensor([0.7472, 0.9910, 0.9455, 0.7890, 0.5803, 0.5585, 0.8524, 0.9579],
       device='cuda:0')
INFO:root:rank 0/iteration 600: Current Top 1 Accuracy: 0.7588741183280945, Current Top 1 PC Accuracy: tensor([0.7619, 0.9897, 0.9452, 0.7910, 0.5754, 0.5683, 0.8674, 0.9497],
       device='cuda:0')
INFO:root:rank 1/iteration 600: Current Top 1 Accuracy: 0.7574875354766846, Current Top 1 PC Accuracy: tensor([0.7690, 0.9912, 0.9473, 0.7795, 0.5702, 0.5736, 0.8609, 0.9545],
       device='cuda:0')
INFO:root:rank 2/iteration 600: Current Top 1 Accuracy: 0.7574875354766846, Current Top 1 PC Accuracy: tensor([0.7690, 0.9898, 0.9455, 0.7820, 0.5747, 0.5693, 0.8617, 0.9505],
       device='cuda:0')
INFO:root:rank 0/iteration 620: Current Top 1 Accuracy: 0.7592592835426331, Current Top 1 PC Accuracy: tensor([0.7727, 0.9897, 0.9452, 0.7665, 0.5722, 0.5877, 0.8656, 0.9551],
       device='cuda:0')
INFO:root:rank 1/iteration 620: Current Top 1 Accuracy: 0.7579173445701599, Current Top 1 PC Accuracy: tensor([0.7791, 0.9912, 0.9473, 0.7518, 0.5676, 0.5923, 0.8596, 0.9602],
       device='cuda:0')
INFO:root:rank 2/iteration 620: Current Top 1 Accuracy: 0.7576489448547363, Current Top 1 PC Accuracy: tensor([0.7802, 0.9898, 0.9455, 0.7599, 0.5724, 0.5864, 0.8550, 0.9538],
       device='cuda:0')
INFO:root:rank 0/iteration 640: Current Top 1 Accuracy: 0.7609204649925232, Current Top 1 PC Accuracy: tensor([0.7765, 0.9898, 0.9452, 0.7470, 0.5716, 0.6012, 0.8701, 0.9597],
       device='cuda:0')
INFO:root:rank 1/iteration 640: Current Top 1 Accuracy: 0.7601404190063477, Current Top 1 PC Accuracy: tensor([0.7823, 0.9913, 0.9473, 0.7339, 0.5656, 0.6091, 0.8667, 0.9646],
       device='cuda:0')
INFO:root:rank 2/iteration 640: Current Top 1 Accuracy: 0.7593603730201721, Current Top 1 PC Accuracy: tensor([0.7838, 0.9899, 0.9455, 0.7398, 0.5709, 0.6011, 0.8631, 0.9558],
       device='cuda:0')
INFO:root:rank 0/iteration 660: Current Top 1 Accuracy: 0.7556732296943665, Current Top 1 PC Accuracy: tensor([0.7466, 0.9866, 0.9463, 0.7361, 0.5834, 0.6002, 0.8350, 0.9571],
       device='cuda:0')
INFO:root:rank 1/iteration 660: Current Top 1 Accuracy: 0.754790723323822, Current Top 1 PC Accuracy: tensor([0.7587, 0.9905, 0.9484, 0.7202, 0.5777, 0.6059, 0.8315, 0.9646],
       device='cuda:0')
INFO:root:rank 2/iteration 660: Current Top 1 Accuracy: 0.7546646595001221, Current Top 1 PC Accuracy: tensor([0.7621, 0.9879, 0.9468, 0.7279, 0.5829, 0.5979, 0.8304, 0.9558],
       device='cuda:0')
INFO:root:rank 0/iteration 680: Current Top 1 Accuracy: 0.7523249983787537, Current Top 1 PC Accuracy: tensor([0.7466, 0.9835, 0.9486, 0.7118, 0.5924, 0.5975, 0.8173, 0.9520],
       device='cuda:0')
INFO:root:rank 1/iteration 680: Current Top 1 Accuracy: 0.7514684200286865, Current Top 1 PC Accuracy: tensor([0.7587, 0.9839, 0.9506, 0.7002, 0.5876, 0.6027, 0.8131, 0.9620],
       device='cuda:0')
INFO:root:rank 2/iteration 680: Current Top 1 Accuracy: 0.7514684200286865, Current Top 1 PC Accuracy: tensor([0.7621, 0.9836, 0.9491, 0.7062, 0.5925, 0.5942, 0.8115, 0.9558],
       device='cuda:0')
INFO:root:rank 0/iteration 700: Current Top 1 Accuracy: 0.7460770606994629, Current Top 1 PC Accuracy: tensor([0.7221, 0.9804, 0.9506, 0.6974, 0.5999, 0.5975, 0.7823, 0.9495],
       device='cuda:0')
INFO:root:rank 1/iteration 700: Current Top 1 Accuracy: 0.7456015348434448, Current Top 1 PC Accuracy: tensor([0.7315, 0.9809, 0.9525, 0.6886, 0.5954, 0.6027, 0.7781, 0.9620],
       device='cuda:0')
INFO:root:rank 2/iteration 700: Current Top 1 Accuracy: 0.7456015348434448, Current Top 1 PC Accuracy: tensor([0.7366, 0.9795, 0.9510, 0.6942, 0.6004, 0.5942, 0.7768, 0.9558],
       device='cuda:0')
INFO:root:rank 0/iteration 720: Current Top 1 Accuracy: 0.7426028847694397, Current Top 1 PC Accuracy: tensor([0.7221, 0.9812, 0.9518, 0.6833, 0.6109, 0.5898, 0.7602, 0.9469],
       device='cuda:0')
INFO:root:rank 1/iteration 720: Current Top 1 Accuracy: 0.7422561049461365, Current Top 1 PC Accuracy: tensor([0.7315, 0.9805, 0.9535, 0.6774, 0.6068, 0.5963, 0.7544, 0.9593],
       device='cuda:0')
INFO:root:rank 2/iteration 720: Current Top 1 Accuracy: 0.7408691644668579, Current Top 1 PC Accuracy: tensor([0.7366, 0.9802, 0.9518, 0.6750, 0.6113, 0.5880, 0.7528, 0.9505],
       device='cuda:0')
INFO:root:rank 0/iteration 740: Current Top 1 Accuracy: 0.73886638879776, Current Top 1 PC Accuracy: tensor([0.7221, 0.9782, 0.9533, 0.6604, 0.6153, 0.5981, 0.7429, 0.9452],
       device='cuda:0')
INFO:root:rank 1/iteration 740: Current Top 1 Accuracy: 0.7375168800354004, Current Top 1 PC Accuracy: tensor([0.7315, 0.9765, 0.9549, 0.6490, 0.6118, 0.6046, 0.7368, 0.9598],
       device='cuda:0')
INFO:root:rank 2/iteration 740: Current Top 1 Accuracy: 0.736729621887207, Current Top 1 PC Accuracy: tensor([0.7366, 0.9762, 0.9530, 0.6506, 0.6161, 0.5971, 0.7364, 0.9464],
       device='cuda:0')
INFO:root:rank 0/iteration 760: Current Top 1 Accuracy: 0.7403635382652283, Current Top 1 PC Accuracy: tensor([0.7245, 0.9782, 0.9533, 0.6488, 0.6122, 0.6073, 0.7546, 0.9521],
       device='cuda:0')
INFO:root:rank 1/iteration 760: Current Top 1 Accuracy: 0.7395970225334167, Current Top 1 PC Accuracy: tensor([0.7357, 0.9765, 0.9549, 0.6382, 0.6099, 0.6139, 0.7487, 0.9651],
       device='cuda:0')
INFO:root:rank 2/iteration 760: Current Top 1 Accuracy: 0.7389400005340576, Current Top 1 PC Accuracy: tensor([0.7412, 0.9762, 0.9530, 0.6409, 0.6145, 0.6057, 0.7486, 0.9533],
       device='cuda:0')
INFO:root:rank 0/iteration 768: Current Top 1 Accuracy: 0.7409416437149048, Current Top 1 PC Accuracy: tensor([0.7263, 0.9782, 0.9533, 0.6445, 0.6117, 0.6135, 0.7574, 0.9530],
       device='cuda:0')
[rank0]:[W1115 16:04:27.241979824 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 1/iteration 768: Current Top 1 Accuracy: 0.7406162023544312, Current Top 1 PC Accuracy: tensor([0.7391, 0.9765, 0.9549, 0.6346, 0.6099, 0.6201, 0.7526, 0.9658],
       device='cuda:0')
[rank1]:[W1115 16:04:29.010123584 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 2/iteration 768: Current Top 1 Accuracy: 0.7395313382148743, Current Top 1 PC Accuracy: tensor([0.7429, 0.9762, 0.9530, 0.6356, 0.6145, 0.6117, 0.7520, 0.9541],
       device='cuda:0')
[rank2]:[W1115 16:04:33.433089661 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:called-params /mnt/slurm/lennart/jepaslt/configs/evals/vith16_384_ravdess_split_2_pretrained_full_video.yaml
INFO:root:loaded params...
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/2_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_2'},
    'tag': 'ravdess_2-16x8x3',
    'tasks_per_node': 3}
INFO:root:Running... (rank: 0/3)
INFO:root:Running evaluation: pretrained_full_video_classification
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/2_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_2'},
    'tag': 'ravdess_2-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 1/3
INFO:root:Initialized (rank/world-size) 0/3
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/2_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_2'},
    'tag': 'ravdess_2-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 2/3
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:Indexed a total number of 600 videos containing 28267 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 786
INFO:root:Indexed a total number of 600 videos containing 28267 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 786
INFO:root:Indexed a total number of 600 videos containing 28267 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 786
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 1/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, 1., nan, nan, nan, nan, nan], device='cuda:0')
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
INFO:root:rank 2/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, 1., nan, nan, nan, nan, nan], device='cuda:0')
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 0/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, 1., nan, nan, nan, nan, nan], device='cuda:0')
INFO:root:rank 2/iteration 20: Current Top 1 Accuracy: 0.6865079402923584, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9143, 0.6875, 0.8919,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 20: Current Top 1 Accuracy: 0.6984127163887024, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9189, 0.6418, 0.8529,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 20: Current Top 1 Accuracy: 0.7103174328804016, Current Top 1 PC Accuracy: tensor([   nan, 1.0000, 0.9079, 0.6719, 0.8421,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 40: Current Top 1 Accuracy: 0.7113820910453796, Current Top 1 PC Accuracy: tensor([   nan, 0.9891, 0.9008, 0.6333, 0.9286, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 40: Current Top 1 Accuracy: 0.727642297744751, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8978, 0.6341, 0.9265, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 40: Current Top 1 Accuracy: 0.727642297744751, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.9248, 0.6134, 0.8784, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 60: Current Top 1 Accuracy: 0.6748633980751038, Current Top 1 PC Accuracy: tensor([1.0000, 0.8571, 0.8993, 0.6029, 0.8442, 0.4000, 1.0000, 0.2249],
       device='cuda:0')
INFO:root:rank 1/iteration 60: Current Top 1 Accuracy: 0.6912568211555481, Current Top 1 PC Accuracy: tensor([0.8125, 0.8870, 0.8854, 0.6115, 0.8514, 0.4167, 1.0000, 0.2357],
       device='cuda:0')
INFO:root:rank 0/iteration 60: Current Top 1 Accuracy: 0.6857923269271851, Current Top 1 PC Accuracy: tensor([0.9167, 0.8629, 0.9145, 0.5878, 0.7927, 0.3684, 1.0000, 0.2468],
       device='cuda:0')
INFO:root:rank 2/iteration 80: Current Top 1 Accuracy: 0.6604938507080078, Current Top 1 PC Accuracy: tensor([1.0000, 0.7786, 0.8221, 0.5541, 0.8025, 0.7097, 1.0000, 0.3604],
       device='cuda:0')
INFO:root:rank 1/iteration 80: Current Top 1 Accuracy: 0.6707819104194641, Current Top 1 PC Accuracy: tensor([0.8696, 0.8095, 0.8035, 0.5629, 0.8182, 0.7586, 1.0000, 0.3630],
       device='cuda:0')
INFO:root:rank 0/iteration 80: Current Top 1 Accuracy: 0.6656378507614136, Current Top 1 PC Accuracy: tensor([0.9500, 0.8045, 0.7989, 0.5385, 0.7647, 0.6389, 1.0000, 0.3764],
       device='cuda:0')
INFO:root:rank 2/iteration 100: Current Top 1 Accuracy: 0.655940592288971, Current Top 1 PC Accuracy: tensor([0.9600, 0.6939, 0.8121, 0.5223, 0.7927, 0.7273, 1.0000, 0.4084],
       device='cuda:0')
INFO:root:rank 1/iteration 100: Current Top 1 Accuracy: 0.6641914248466492, Current Top 1 PC Accuracy: tensor([0.9091, 0.7183, 0.7989, 0.5312, 0.7778, 0.7778, 1.0000, 0.4139],
       device='cuda:0')
INFO:root:rank 0/iteration 100: Current Top 1 Accuracy: 0.6592409014701843, Current Top 1 PC Accuracy: tensor([0.9394, 0.7230, 0.7898, 0.5066, 0.7222, 0.6829, 1.0000, 0.4211],
       device='cuda:0')
INFO:root:rank 2/iteration 120: Current Top 1 Accuracy: 0.647382915019989, Current Top 1 PC Accuracy: tensor([0.9688, 0.6562, 0.7732, 0.5029, 0.7596, 0.8200, 1.0000, 0.4125],
       device='cuda:0')
INFO:root:rank 1/iteration 120: Current Top 1 Accuracy: 0.6522038578987122, Current Top 1 PC Accuracy: tensor([0.9189, 0.6646, 0.7524, 0.5056, 0.7476, 0.8491, 1.0000, 0.4174],
       device='cuda:0')
INFO:root:rank 0/iteration 120: Current Top 1 Accuracy: 0.6466942429542542, Current Top 1 PC Accuracy: tensor([0.9474, 0.6728, 0.7368, 0.4854, 0.7054, 0.7797, 1.0000, 0.4203],
       device='cuda:0')
INFO:root:rank 2/iteration 140: Current Top 1 Accuracy: 0.6453900933265686, Current Top 1 PC Accuracy: tensor([0.9688, 0.7381, 0.7928, 0.5000, 0.7934, 0.8200, 1.0000, 0.3796],
       device='cuda:0')
INFO:root:rank 1/iteration 140: Current Top 1 Accuracy: 0.6489361524581909, Current Top 1 PC Accuracy: tensor([0.8947, 0.7376, 0.7695, 0.5079, 0.7833, 0.8491, 1.0000, 0.3840],
       device='cuda:0')
INFO:root:rank 0/iteration 140: Current Top 1 Accuracy: 0.6453900933265686, Current Top 1 PC Accuracy: tensor([0.9231, 0.7476, 0.7601, 0.4877, 0.7442, 0.7797, 1.0000, 0.3877],
       device='cuda:0')
INFO:root:rank 2/iteration 160: Current Top 1 Accuracy: 0.6630434989929199, Current Top 1 PC Accuracy: tensor([0.9688, 0.7909, 0.8201, 0.5417, 0.8217, 0.7193, 1.0000, 0.3628],
       device='cuda:0')
INFO:root:rank 1/iteration 160: Current Top 1 Accuracy: 0.6682194471359253, Current Top 1 PC Accuracy: tensor([0.8947, 0.7931, 0.8081, 0.5514, 0.8129, 0.7143, 1.0000, 0.3675],
       device='cuda:0')
INFO:root:rank 0/iteration 160: Current Top 1 Accuracy: 0.6651138663291931, Current Top 1 PC Accuracy: tensor([0.9231, 0.8000, 0.7954, 0.5296, 0.7892, 0.6667, 1.0000, 0.3736],
       device='cuda:0')
INFO:root:rank 2/iteration 180: Current Top 1 Accuracy: 0.6620625853538513, Current Top 1 PC Accuracy: tensor([0.7949, 0.7606, 0.8235, 0.5823, 0.8441, 0.5694, 0.9680, 0.3534],
       device='cuda:0')
INFO:root:rank 1/iteration 180: Current Top 1 Accuracy: 0.6652854681015015, Current Top 1 PC Accuracy: tensor([0.7556, 0.7666, 0.8061, 0.5913, 0.8361, 0.5844, 0.9643, 0.3562],
       device='cuda:0')
INFO:root:rank 0/iteration 180: Current Top 1 Accuracy: 0.6629834175109863, Current Top 1 PC Accuracy: tensor([0.8000, 0.7734, 0.8020, 0.5692, 0.8125, 0.5349, 0.9634, 0.3625],
       device='cuda:0')
INFO:root:rank 2/iteration 200: Current Top 1 Accuracy: 0.6650083065032959, Current Top 1 PC Accuracy: tensor([0.6739, 0.7429, 0.8161, 0.6384, 0.8585, 0.4227, 0.9641, 0.3522],
       device='cuda:0')
INFO:root:rank 1/iteration 200: Current Top 1 Accuracy: 0.666252076625824, Current Top 1 PC Accuracy: tensor([0.6800, 0.7440, 0.7983, 0.6413, 0.8515, 0.4412, 0.9567, 0.3543],
       device='cuda:0')
INFO:root:rank 0/iteration 200: Current Top 1 Accuracy: 0.667495846748352, Current Top 1 PC Accuracy: tensor([0.7200, 0.7590, 0.7953, 0.6267, 0.8318, 0.4220, 0.9556, 0.3611],
       device='cuda:0')
INFO:root:rank 2/iteration 220: Current Top 1 Accuracy: 0.6451734304428101, Current Top 1 PC Accuracy: tensor([0.6765, 0.6784, 0.7679, 0.6148, 0.8544, 0.3881, 0.9538, 0.3682],
       device='cuda:0')
INFO:root:rank 1/iteration 220: Current Top 1 Accuracy: 0.6481900215148926, Current Top 1 PC Accuracy: tensor([0.6622, 0.6878, 0.7639, 0.6130, 0.8390, 0.4267, 0.9502, 0.3715],
       device='cuda:0')
INFO:root:rank 0/iteration 220: Current Top 1 Accuracy: 0.6485671401023865, Current Top 1 PC Accuracy: tensor([0.6800, 0.7004, 0.7566, 0.6005, 0.8241, 0.3987, 0.9463, 0.3804],
       device='cuda:0')
INFO:root:rank 2/iteration 240: Current Top 1 Accuracy: 0.6345089673995972, Current Top 1 PC Accuracy: tensor([0.6105, 0.6315, 0.7208, 0.5810, 0.8502, 0.4790, 0.9587, 0.4110],
       device='cuda:0')
INFO:root:rank 1/iteration 240: Current Top 1 Accuracy: 0.6376210451126099, Current Top 1 PC Accuracy: tensor([0.5865, 0.6443, 0.7223, 0.5813, 0.8230, 0.5000, 0.9556, 0.4159],
       device='cuda:0')
INFO:root:rank 0/iteration 240: Current Top 1 Accuracy: 0.638658344745636, Current Top 1 PC Accuracy: tensor([0.6263, 0.6484, 0.7159, 0.5721, 0.8165, 0.4920, 0.9496, 0.4221],
       device='cuda:0')
INFO:root:rank 2/iteration 260: Current Top 1 Accuracy: 0.6162196397781372, Current Top 1 PC Accuracy: tensor([0.5917, 0.5782, 0.6716, 0.5601, 0.8421, 0.4579, 0.9636, 0.4254],
       device='cuda:0')
INFO:root:rank 1/iteration 260: Current Top 1 Accuracy: 0.6197317838668823, Current Top 1 PC Accuracy: tensor([0.5923, 0.5874, 0.6764, 0.5619, 0.8190, 0.4764, 0.9607, 0.4294],
       device='cuda:0')
INFO:root:rank 0/iteration 260: Current Top 1 Accuracy: 0.6197317838668823, Current Top 1 PC Accuracy: tensor([0.6148, 0.5918, 0.6661, 0.5583, 0.8091, 0.4661, 0.9557, 0.4333],
       device='cuda:0')
INFO:root:rank 2/iteration 280: Current Top 1 Accuracy: 0.6147686839103699, Current Top 1 PC Accuracy: tensor([0.5714, 0.5677, 0.6431, 0.5381, 0.8302, 0.5041, 0.9648, 0.4570],
       device='cuda:0')
INFO:root:rank 1/iteration 280: Current Top 1 Accuracy: 0.6168445944786072, Current Top 1 PC Accuracy: tensor([0.5769, 0.5700, 0.6492, 0.5400, 0.8152, 0.5114, 0.9619, 0.4616],
       device='cuda:0')
INFO:root:rank 0/iteration 280: Current Top 1 Accuracy: 0.6186239719390869, Current Top 1 PC Accuracy: tensor([0.5906, 0.5783, 0.6431, 0.5324, 0.7946, 0.5076, 0.9600, 0.4689],
       device='cuda:0')
INFO:root:rank 2/iteration 300: Current Top 1 Accuracy: 0.619601309299469, Current Top 1 PC Accuracy: tensor([0.5419, 0.5763, 0.6629, 0.5795, 0.8506, 0.4803, 0.9427, 0.4485],
       device='cuda:0')
INFO:root:rank 1/iteration 300: Current Top 1 Accuracy: 0.6212624311447144, Current Top 1 PC Accuracy: tensor([0.5521, 0.5768, 0.6672, 0.5806, 0.8361, 0.4839, 0.9506, 0.4526],
       device='cuda:0')
INFO:root:rank 0/iteration 300: Current Top 1 Accuracy: 0.6212624311447144, Current Top 1 PC Accuracy: tensor([0.5605, 0.5842, 0.6604, 0.5726, 0.8160, 0.4803, 0.9358, 0.4596],
       device='cuda:0')
INFO:root:rank 2/iteration 320: Current Top 1 Accuracy: 0.6222741603851318, Current Top 1 PC Accuracy: tensor([0.5217, 0.5911, 0.6720, 0.6012, 0.8626, 0.4420, 0.9278, 0.4467],
       device='cuda:0')
INFO:root:rank 1/iteration 320: Current Top 1 Accuracy: 0.624091386795044, Current Top 1 PC Accuracy: tensor([0.5294, 0.5953, 0.6782, 0.6039, 0.8471, 0.4426, 0.9352, 0.4508],
       device='cuda:0')
INFO:root:rank 0/iteration 320: Current Top 1 Accuracy: 0.6235721707344055, Current Top 1 PC Accuracy: tensor([0.5333, 0.5990, 0.6729, 0.5980, 0.8264, 0.4365, 0.9231, 0.4589],
       device='cuda:0')
INFO:root:rank 2/iteration 340: Current Top 1 Accuracy: 0.6243890523910522, Current Top 1 PC Accuracy: tensor([0.4693, 0.5817, 0.6943, 0.6164, 0.8780, 0.4388, 0.9154, 0.4437],
       device='cuda:0')
INFO:root:rank 1/iteration 340: Current Top 1 Accuracy: 0.6268328428268433, Current Top 1 PC Accuracy: tensor([0.4891, 0.5864, 0.7011, 0.6169, 0.8655, 0.4412, 0.9203, 0.4464],
       device='cuda:0')
INFO:root:rank 0/iteration 340: Current Top 1 Accuracy: 0.6273216009140015, Current Top 1 PC Accuracy: tensor([0.4835, 0.5937, 0.6952, 0.6185, 0.8456, 0.4351, 0.9067, 0.4551],
       device='cuda:0')
INFO:root:rank 2/iteration 360: Current Top 1 Accuracy: 0.6255770921707153, Current Top 1 PC Accuracy: tensor([0.4078, 0.5784, 0.7051, 0.6136, 0.8853, 0.4409, 0.9118, 0.4462],
       device='cuda:0')
INFO:root:rank 1/iteration 360: Current Top 1 Accuracy: 0.6281163692474365, Current Top 1 PC Accuracy: tensor([0.4306, 0.5845, 0.7113, 0.6145, 0.8716, 0.4430, 0.9205, 0.4464],
       device='cuda:0')
INFO:root:rank 0/iteration 360: Current Top 1 Accuracy: 0.6290397047996521, Current Top 1 PC Accuracy: tensor([0.4251, 0.5911, 0.7066, 0.6157, 0.8571, 0.4351, 0.9036, 0.4568],
       device='cuda:0')
INFO:root:rank 2/iteration 380: Current Top 1 Accuracy: 0.6233595609664917, Current Top 1 PC Accuracy: tensor([0.4462, 0.5741, 0.6561, 0.6102, 0.8827, 0.4757, 0.9188, 0.4683],
       device='cuda:0')
INFO:root:rank 1/iteration 380: Current Top 1 Accuracy: 0.6246719360351562, Current Top 1 PC Accuracy: tensor([0.4669, 0.5789, 0.6609, 0.6112, 0.8690, 0.4683, 0.9266, 0.4679],
       device='cuda:0')
INFO:root:rank 0/iteration 380: Current Top 1 Accuracy: 0.6257655024528503, Current Top 1 PC Accuracy: tensor([0.4646, 0.5867, 0.6566, 0.6101, 0.8571, 0.4643, 0.9110, 0.4776],
       device='cuda:0')
INFO:root:rank 2/iteration 400: Current Top 1 Accuracy: 0.6205319762229919, Current Top 1 PC Accuracy: tensor([0.4765, 0.5652, 0.6237, 0.6025, 0.8776, 0.4927, 0.9273, 0.4791],
       device='cuda:0')
INFO:root:rank 1/iteration 400: Current Top 1 Accuracy: 0.6201163530349731, Current Top 1 PC Accuracy: tensor([0.4917, 0.5682, 0.6246, 0.6057, 0.8563, 0.4833, 0.9338, 0.4803],
       device='cuda:0')
INFO:root:rank 0/iteration 400: Current Top 1 Accuracy: 0.6207398176193237, Current Top 1 PC Accuracy: tensor([0.4933, 0.5775, 0.6186, 0.6036, 0.8497, 0.4822, 0.9189, 0.4875],
       device='cuda:0')
INFO:root:rank 2/iteration 420: Current Top 1 Accuracy: 0.6221298575401306, Current Top 1 PC Accuracy: tensor([0.4954, 0.5527, 0.6159, 0.6116, 0.8815, 0.5111, 0.9276, 0.4885],
       device='cuda:0')
INFO:root:rank 1/iteration 420: Current Top 1 Accuracy: 0.6219319105148315, Current Top 1 PC Accuracy: tensor([0.5106, 0.5578, 0.6139, 0.6136, 0.8599, 0.5052, 0.9317, 0.4923],
       device='cuda:0')
INFO:root:rank 0/iteration 420: Current Top 1 Accuracy: 0.6213380694389343, Current Top 1 PC Accuracy: tensor([0.5091, 0.5684, 0.6078, 0.6122, 0.8552, 0.4961, 0.9192, 0.4940],
       device='cuda:0')
INFO:root:rank 2/iteration 440: Current Top 1 Accuracy: 0.624716579914093, Current Top 1 PC Accuracy: tensor([0.4670, 0.5585, 0.6333, 0.6164, 0.8925, 0.5111, 0.9171, 0.4869],
       device='cuda:0')
INFO:root:rank 1/iteration 440: Current Top 1 Accuracy: 0.6237717270851135, Current Top 1 PC Accuracy: tensor([0.4815, 0.5637, 0.6300, 0.6143, 0.8722, 0.5052, 0.9192, 0.4911],
       device='cuda:0')
INFO:root:rank 0/iteration 440: Current Top 1 Accuracy: 0.6228269338607788, Current Top 1 PC Accuracy: tensor([0.4758, 0.5731, 0.6251, 0.6146, 0.8668, 0.4961, 0.9100, 0.4905],
       device='cuda:0')
INFO:root:rank 2/iteration 460: Current Top 1 Accuracy: 0.6290672421455383, Current Top 1 PC Accuracy: tensor([0.4703, 0.5600, 0.6425, 0.6145, 0.8983, 0.5319, 0.8866, 0.4950],
       device='cuda:0')
INFO:root:rank 1/iteration 460: Current Top 1 Accuracy: 0.6259942054748535, Current Top 1 PC Accuracy: tensor([0.4799, 0.5623, 0.6385, 0.6132, 0.8768, 0.5237, 0.8874, 0.4937],
       device='cuda:0')
INFO:root:rank 0/iteration 460: Current Top 1 Accuracy: 0.6258134245872498, Current Top 1 PC Accuracy: tensor([0.4718, 0.5698, 0.6346, 0.6121, 0.8738, 0.5162, 0.8821, 0.4983],
       device='cuda:0')
INFO:root:rank 2/iteration 480: Current Top 1 Accuracy: 0.6323631405830383, Current Top 1 PC Accuracy: tensor([0.5000, 0.5590, 0.6326, 0.5935, 0.8796, 0.5405, 0.8815, 0.5127],
       device='cuda:0')
INFO:root:rank 1/iteration 480: Current Top 1 Accuracy: 0.6292446255683899, Current Top 1 PC Accuracy: tensor([0.5038, 0.5590, 0.6288, 0.5941, 0.8625, 0.5307, 0.8823, 0.5131],
       device='cuda:0')
INFO:root:rank 0/iteration 480: Current Top 1 Accuracy: 0.630630612373352, Current Top 1 PC Accuracy: tensor([0.5013, 0.5688, 0.6263, 0.5951, 0.8615, 0.5280, 0.8775, 0.5185],
       device='cuda:0')
INFO:root:rank 2/iteration 500: Current Top 1 Accuracy: 0.6365602016448975, Current Top 1 PC Accuracy: tensor([0.5012, 0.5598, 0.6385, 0.5947, 0.8820, 0.5597, 0.8699, 0.5219],
       device='cuda:0')
INFO:root:rank 1/iteration 500: Current Top 1 Accuracy: 0.6330671906471252, Current Top 1 PC Accuracy: tensor([0.5074, 0.5585, 0.6347, 0.5969, 0.8638, 0.5474, 0.8671, 0.5220],
       device='cuda:0')
INFO:root:rank 0/iteration 500: Current Top 1 Accuracy: 0.6347305178642273, Current Top 1 PC Accuracy: tensor([0.5074, 0.5696, 0.6311, 0.5953, 0.8646, 0.5446, 0.8657, 0.5272],
       device='cuda:0')
INFO:root:rank 2/iteration 520: Current Top 1 Accuracy: 0.6394753456115723, Current Top 1 PC Accuracy: tensor([0.5012, 0.5804, 0.6532, 0.5984, 0.8950, 0.5583, 0.8115, 0.5213],
       device='cuda:0')
INFO:root:rank 1/iteration 520: Current Top 1 Accuracy: 0.634996771812439, Current Top 1 PC Accuracy: tensor([0.5074, 0.5785, 0.6486, 0.6006, 0.8778, 0.5448, 0.8035, 0.5214],
       device='cuda:0')
INFO:root:rank 0/iteration 520: Current Top 1 Accuracy: 0.6373960375785828, Current Top 1 PC Accuracy: tensor([0.5074, 0.5907, 0.6457, 0.5997, 0.8783, 0.5421, 0.8046, 0.5272],
       device='cuda:0')
INFO:root:rank 2/iteration 540: Current Top 1 Accuracy: 0.6435613036155701, Current Top 1 PC Accuracy: tensor([0.5012, 0.6021, 0.6658, 0.6022, 0.9016, 0.5583, 0.7752, 0.5151],
       device='cuda:0')
INFO:root:rank 1/iteration 540: Current Top 1 Accuracy: 0.6394023299217224, Current Top 1 PC Accuracy: tensor([0.5074, 0.5999, 0.6621, 0.6043, 0.8881, 0.5435, 0.7662, 0.5155],
       device='cuda:0')
INFO:root:rank 0/iteration 540: Current Top 1 Accuracy: 0.6409426927566528, Current Top 1 PC Accuracy: tensor([0.5074, 0.6119, 0.6585, 0.6028, 0.8897, 0.5421, 0.7647, 0.5191],
       device='cuda:0')
INFO:root:rank 2/iteration 560: Current Top 1 Accuracy: 0.6466131806373596, Current Top 1 PC Accuracy: tensor([0.4963, 0.6182, 0.6823, 0.6154, 0.9043, 0.5583, 0.7369, 0.5115],
       device='cuda:0')
INFO:root:rank 1/iteration 560: Current Top 1 Accuracy: 0.6424539685249329, Current Top 1 PC Accuracy: tensor([0.5012, 0.6156, 0.6783, 0.6181, 0.8917, 0.5435, 0.7287, 0.5113],
       device='cuda:0')
INFO:root:rank 0/iteration 560: Current Top 1 Accuracy: 0.6440879106521606, Current Top 1 PC Accuracy: tensor([0.5049, 0.6278, 0.6750, 0.6157, 0.8929, 0.5408, 0.7272, 0.5148],
       device='cuda:0')
INFO:root:rank 2/iteration 580: Current Top 1 Accuracy: 0.6478772163391113, Current Top 1 PC Accuracy: tensor([0.4963, 0.6337, 0.6953, 0.6171, 0.9106, 0.5556, 0.6946, 0.5079],
       device='cuda:0')
INFO:root:rank 1/iteration 580: Current Top 1 Accuracy: 0.6442914605140686, Current Top 1 PC Accuracy: tensor([0.5012, 0.6313, 0.6918, 0.6187, 0.8991, 0.5397, 0.6895, 0.5076],
       device='cuda:0')
INFO:root:rank 0/iteration 580: Current Top 1 Accuracy: 0.6462994813919067, Current Top 1 PC Accuracy: tensor([0.5049, 0.6434, 0.6885, 0.6174, 0.9005, 0.5383, 0.6867, 0.5127],
       device='cuda:0')
INFO:root:rank 2/iteration 600: Current Top 1 Accuracy: 0.6508596539497375, Current Top 1 PC Accuracy: tensor([0.5188, 0.6320, 0.6948, 0.6029, 0.9047, 0.5745, 0.7018, 0.5214],
       device='cuda:0')
INFO:root:rank 1/iteration 600: Current Top 1 Accuracy: 0.6473932266235352, Current Top 1 PC Accuracy: tensor([0.5200, 0.6279, 0.6918, 0.6070, 0.8919, 0.5612, 0.6977, 0.5219],
       device='cuda:0')
INFO:root:rank 0/iteration 600: Current Top 1 Accuracy: 0.6494730710983276, Current Top 1 PC Accuracy: tensor([0.5280, 0.6421, 0.6879, 0.6049, 0.8934, 0.5588, 0.6935, 0.5259],
       device='cuda:0')
INFO:root:rank 2/iteration 620: Current Top 1 Accuracy: 0.6515029668807983, Current Top 1 PC Accuracy: tensor([0.5383, 0.6277, 0.6840, 0.5893, 0.9020, 0.5955, 0.7104, 0.5322],
       device='cuda:0')
INFO:root:rank 1/iteration 620: Current Top 1 Accuracy: 0.6477455496788025, Current Top 1 PC Accuracy: tensor([0.5416, 0.6237, 0.6807, 0.5957, 0.8892, 0.5809, 0.7054, 0.5302],
       device='cuda:0')
INFO:root:rank 0/iteration 620: Current Top 1 Accuracy: 0.6504294276237488, Current Top 1 PC Accuracy: tensor([0.5491, 0.6390, 0.6785, 0.5929, 0.8892, 0.5775, 0.7031, 0.5353],
       device='cuda:0')
INFO:root:rank 2/iteration 640: Current Top 1 Accuracy: 0.6561362743377686, Current Top 1 PC Accuracy: tensor([0.5383, 0.6394, 0.6926, 0.5901, 0.9062, 0.5928, 0.7059, 0.5380],
       device='cuda:0')
INFO:root:rank 1/iteration 640: Current Top 1 Accuracy: 0.6517160534858704, Current Top 1 PC Accuracy: tensor([0.5404, 0.6329, 0.6902, 0.5976, 0.8934, 0.5809, 0.6994, 0.5339],
       device='cuda:0')
INFO:root:rank 0/iteration 640: Current Top 1 Accuracy: 0.6545761823654175, Current Top 1 PC Accuracy: tensor([0.5491, 0.6502, 0.6873, 0.5900, 0.8925, 0.5763, 0.6981, 0.5411],
       device='cuda:0')
INFO:root:rank 2/iteration 660: Current Top 1 Accuracy: 0.6562027335166931, Current Top 1 PC Accuracy: tensor([0.5288, 0.6450, 0.7037, 0.5949, 0.9039, 0.5863, 0.6892, 0.5346],
       device='cuda:0')
INFO:root:rank 1/iteration 660: Current Top 1 Accuracy: 0.651538074016571, Current Top 1 PC Accuracy: tensor([0.5308, 0.6387, 0.7008, 0.6034, 0.8919, 0.5747, 0.6807, 0.5296],
       device='cuda:0')
INFO:root:rank 0/iteration 660: Current Top 1 Accuracy: 0.6545637845993042, Current Top 1 PC Accuracy: tensor([0.5419, 0.6546, 0.6972, 0.5946, 0.8924, 0.5702, 0.6814, 0.5376],
       device='cuda:0')
INFO:root:rank 2/iteration 680: Current Top 1 Accuracy: 0.6560205817222595, Current Top 1 PC Accuracy: tensor([0.5281, 0.6411, 0.7063, 0.5812, 0.8892, 0.5887, 0.6968, 0.5473],
       device='cuda:0')
INFO:root:rank 1/iteration 680: Current Top 1 Accuracy: 0.6519823670387268, Current Top 1 PC Accuracy: tensor([0.5313, 0.6346, 0.7040, 0.5891, 0.8787, 0.5773, 0.6893, 0.5439],
       device='cuda:0')
INFO:root:rank 0/iteration 680: Current Top 1 Accuracy: 0.6546744704246521, Current Top 1 PC Accuracy: tensor([0.5408, 0.6517, 0.7000, 0.5815, 0.8787, 0.5758, 0.6884, 0.5502],
       device='cuda:0')
INFO:root:rank 2/iteration 700: Current Top 1 Accuracy: 0.6563243269920349, Current Top 1 PC Accuracy: tensor([0.5524, 0.6347, 0.7063, 0.5552, 0.8834, 0.6025, 0.7066, 0.5587],
       device='cuda:0')
INFO:root:rank 1/iteration 700: Current Top 1 Accuracy: 0.6526390910148621, Current Top 1 PC Accuracy: tensor([0.5535, 0.6276, 0.7040, 0.5641, 0.8740, 0.5941, 0.6999, 0.5554],
       device='cuda:0')
INFO:root:rank 0/iteration 700: Current Top 1 Accuracy: 0.6553732752799988, Current Top 1 PC Accuracy: tensor([0.5624, 0.6444, 0.7000, 0.5564, 0.8752, 0.5901, 0.7008, 0.5612],
       device='cuda:0')
INFO:root:rank 2/iteration 720: Current Top 1 Accuracy: 0.6584604978561401, Current Top 1 PC Accuracy: tensor([0.5666, 0.6289, 0.7063, 0.5445, 0.8776, 0.6138, 0.7176, 0.5703],
       device='cuda:0')
INFO:root:rank 1/iteration 720: Current Top 1 Accuracy: 0.6547619104385376, Current Top 1 PC Accuracy: tensor([0.5694, 0.6223, 0.7040, 0.5488, 0.8694, 0.6019, 0.7132, 0.5678],
       device='cuda:0')
INFO:root:rank 0/iteration 720: Current Top 1 Accuracy: 0.6573046445846558, Current Top 1 PC Accuracy: tensor([0.5754, 0.6378, 0.7000, 0.5438, 0.8693, 0.6008, 0.7137, 0.5728],
       device='cuda:0')
INFO:root:rank 2/iteration 740: Current Top 1 Accuracy: 0.6563202738761902, Current Top 1 PC Accuracy: tensor([0.5767, 0.6232, 0.7063, 0.5184, 0.8586, 0.6183, 0.7244, 0.5801],
       device='cuda:0')
INFO:root:rank 1/iteration 740: Current Top 1 Accuracy: 0.6532838344573975, Current Top 1 PC Accuracy: tensor([0.5811, 0.6178, 0.7040, 0.5227, 0.8581, 0.6067, 0.7191, 0.5774],
       device='cuda:0')
INFO:root:rank 0/iteration 740: Current Top 1 Accuracy: 0.6564327478408813, Current Top 1 PC Accuracy: tensor([0.5869, 0.6327, 0.7000, 0.5202, 0.8579, 0.6056, 0.7197, 0.5846],
       device='cuda:0')
INFO:root:rank 2/iteration 760: Current Top 1 Accuracy: 0.6593298316001892, Current Top 1 PC Accuracy: tensor([0.5767, 0.6346, 0.7135, 0.5228, 0.8644, 0.6183, 0.7139, 0.5842],
       device='cuda:0')
INFO:root:rank 1/iteration 760: Current Top 1 Accuracy: 0.6565921902656555, Current Top 1 PC Accuracy: tensor([0.5811, 0.6304, 0.7103, 0.5258, 0.8651, 0.6067, 0.7110, 0.5811],
       device='cuda:0')
INFO:root:rank 0/iteration 760: Current Top 1 Accuracy: 0.659877359867096, Current Top 1 PC Accuracy: tensor([0.5869, 0.6445, 0.7070, 0.5234, 0.8652, 0.6056, 0.7122, 0.5878],
       device='cuda:0')
INFO:root:rank 2/iteration 780: Current Top 1 Accuracy: 0.661224901676178, Current Top 1 PC Accuracy: tensor([0.5625, 0.6403, 0.7241, 0.5436, 0.8608, 0.6062, 0.7072, 0.5824],
       device='cuda:0')
INFO:root:rank 1/iteration 780: Current Top 1 Accuracy: 0.6587707996368408, Current Top 1 PC Accuracy: tensor([0.5669, 0.6355, 0.7217, 0.5468, 0.8628, 0.6011, 0.7047, 0.5779],
       device='cuda:0')
INFO:root:rank 2/iteration 785: Current Top 1 Accuracy: 0.6597686409950256, Current Top 1 PC Accuracy: tensor([0.5625, 0.6400, 0.7245, 0.5361, 0.8621, 0.6062, 0.7034, 0.5824],
       device='cuda:0')
[rank2]:[W1115 16:28:38.022169502 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 0/iteration 780: Current Top 1 Accuracy: 0.6625053286552429, Current Top 1 PC Accuracy: tensor([0.5747, 0.6508, 0.7183, 0.5453, 0.8643, 0.6000, 0.7051, 0.5847],
       device='cuda:0')
INFO:root:rank 1/iteration 785: Current Top 1 Accuracy: 0.6572216749191284, Current Top 1 PC Accuracy: tensor([0.5669, 0.6355, 0.7229, 0.5383, 0.8642, 0.6011, 0.7000, 0.5775],
       device='cuda:0')
[rank1]:[W1115 16:28:40.746281371 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 0/iteration 785: Current Top 1 Accuracy: 0.6610421538352966, Current Top 1 PC Accuracy: tensor([0.5747, 0.6508, 0.7193, 0.5367, 0.8660, 0.6000, 0.7008, 0.5847],
       device='cuda:0')
[rank0]:[W1115 16:28:47.698584412 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:called-params /mnt/slurm/lennart/jepaslt/configs/evals/vith16_384_ravdess_split_3_pretrained_full_video.yaml
INFO:root:loaded params...
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/3_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_3'},
    'tag': 'ravdess_3-16x8x3',
    'tasks_per_node': 3}
INFO:root:Running... (rank: 0/3)
INFO:root:Running evaluation: pretrained_full_video_classification
INFO:root:Initialized (rank/world-size) 0/3
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/3_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_3'},
    'tag': 'ravdess_3-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 1/3
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/3_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_3'},
    'tag': 'ravdess_3-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 2/3
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:Indexed a total number of 600 videos containing 29526 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 821
INFO:root:Indexed a total number of 600 videos containing 29526 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 821
INFO:root:Indexed a total number of 600 videos containing 29526 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 821
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 0/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, 1., nan, nan, nan], device='cuda:0')
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
INFO:root:rank 1/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, 1., nan, nan, nan], device='cuda:0')
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 2/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, 1., nan, nan, nan], device='cuda:0')
INFO:root:rank 1/iteration 20: Current Top 1 Accuracy: 0.773809552192688, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8167, 1.0000, 0.7449,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 20: Current Top 1 Accuracy: 0.773809552192688, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8361, 1.0000, 0.7423,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 20: Current Top 1 Accuracy: 0.7658730149269104, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.7903, 1.0000, 0.7347,    nan,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 40: Current Top 1 Accuracy: 0.7825203537940979, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.7857, 1.0000, 0.8087, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 0/iteration 40: Current Top 1 Accuracy: 0.7845528721809387, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.7769, 0.9872, 0.8011, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 40: Current Top 1 Accuracy: 0.7825203537940979, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.7538, 0.9878, 0.8066, 0.0000,    nan, 0.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 60: Current Top 1 Accuracy: 0.7581967115402222, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8250, 0.9896, 0.6803, 0.8750, 0.9048, 0.0385],
       device='cuda:0')
INFO:root:rank 0/iteration 60: Current Top 1 Accuracy: 0.7622950673103333, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8210, 0.9798, 0.6680, 0.8431, 0.9070, 0.0000],
       device='cuda:0')
INFO:root:rank 2/iteration 60: Current Top 1 Accuracy: 0.7568305730819702, Current Top 1 PC Accuracy: tensor([0.0000, 1.0000, 0.8025, 0.9712, 0.6694, 0.8627, 0.9000, 0.0000],
       device='cuda:0')
INFO:root:rank 1/iteration 80: Current Top 1 Accuracy: 0.6779835224151611, Current Top 1 PC Accuracy: tensor([0.0789, 1.0000, 0.8148, 0.8559, 0.5155, 0.7545, 0.9524, 0.2969],
       device='cuda:0')
INFO:root:rank 0/iteration 80: Current Top 1 Accuracy: 0.6759259104728699, Current Top 1 PC Accuracy: tensor([0.0571, 1.0000, 0.8110, 0.7886, 0.5094, 0.7434, 0.9487, 0.3750],
       device='cuda:0')
INFO:root:rank 2/iteration 80: Current Top 1 Accuracy: 0.6759259104728699, Current Top 1 PC Accuracy: tensor([0.0588, 1.0000, 0.7927, 0.8080, 0.5093, 0.7522, 0.9500, 0.3636],
       device='cuda:0')
INFO:root:rank 1/iteration 100: Current Top 1 Accuracy: 0.646039605140686, Current Top 1 PC Accuracy: tensor([0.0789, 1.0000, 0.8148, 0.7661, 0.4192, 0.7939, 0.9737, 0.2872],
       device='cuda:0')
INFO:root:rank 0/iteration 100: Current Top 1 Accuracy: 0.6410890817642212, Current Top 1 PC Accuracy: tensor([0.0571, 1.0000, 0.8110, 0.7132, 0.4137, 0.7831, 0.9718, 0.3370],
       device='cuda:0')
INFO:root:rank 2/iteration 100: Current Top 1 Accuracy: 0.6435643434524536, Current Top 1 PC Accuracy: tensor([0.0588, 1.0000, 0.7927, 0.7372, 0.4162, 0.7778, 0.9728, 0.3256],
       device='cuda:0')
INFO:root:rank 1/iteration 120: Current Top 1 Accuracy: 0.6115702390670776, Current Top 1 PC Accuracy: tensor([0.1667, 1.0000, 0.8098, 0.6376, 0.3517, 0.7617, 0.9789, 0.3500],
       device='cuda:0')
INFO:root:rank 0/iteration 120: Current Top 1 Accuracy: 0.6170799136161804, Current Top 1 PC Accuracy: tensor([0.1538, 1.0000, 0.7964, 0.6340, 0.3505, 0.7712, 0.9783, 0.4160],
       device='cuda:0')
INFO:root:rank 2/iteration 120: Current Top 1 Accuracy: 0.6136363744735718, Current Top 1 PC Accuracy: tensor([0.1111, 1.0000, 0.7879, 0.6352, 0.3534, 0.7480, 0.9783, 0.4118],
       device='cuda:0')
INFO:root:rank 1/iteration 140: Current Top 1 Accuracy: 0.5981087684631348, Current Top 1 PC Accuracy: tensor([0.1167, 1.0000, 0.8049, 0.6264, 0.3394, 0.7760, 0.9819, 0.3289],
       device='cuda:0')
INFO:root:rank 0/iteration 140: Current Top 1 Accuracy: 0.5992907881736755, Current Top 1 PC Accuracy: tensor([0.1053, 1.0000, 0.7895, 0.6201, 0.3383, 0.7756, 0.9809, 0.3885],
       device='cuda:0')
INFO:root:rank 2/iteration 140: Current Top 1 Accuracy: 0.6028369069099426, Current Top 1 PC Accuracy: tensor([0.0741, 1.0000, 0.7902, 0.6349, 0.3439, 0.7585, 0.9811, 0.3893],
       device='cuda:0')
INFO:root:rank 1/iteration 160: Current Top 1 Accuracy: 0.6169772148132324, Current Top 1 PC Accuracy: tensor([0.1111, 1.0000, 0.7875, 0.6977, 0.3876, 0.7729, 0.9819, 0.3012],
       device='cuda:0')
INFO:root:rank 0/iteration 160: Current Top 1 Accuracy: 0.6185300350189209, Current Top 1 PC Accuracy: tensor([0.1017, 1.0000, 0.7734, 0.6951, 0.3836, 0.7725, 0.9809, 0.3631],
       device='cuda:0')
INFO:root:rank 2/iteration 160: Current Top 1 Accuracy: 0.6185300350189209, Current Top 1 PC Accuracy: tensor([0.0714, 1.0000, 0.7701, 0.6987, 0.3896, 0.7500, 0.9811, 0.3537],
       device='cuda:0')
INFO:root:rank 1/iteration 180: Current Top 1 Accuracy: 0.6482504606246948, Current Top 1 PC Accuracy: tensor([0.0897, 1.0000, 0.8185, 0.7431, 0.4616, 0.7729, 0.9644, 0.2976],
       device='cuda:0')
INFO:root:rank 0/iteration 180: Current Top 1 Accuracy: 0.6477900743484497, Current Top 1 PC Accuracy: tensor([0.0845, 1.0000, 0.8000, 0.7348, 0.4581, 0.7725, 0.9535, 0.3609],
       device='cuda:0')
INFO:root:rank 2/iteration 180: Current Top 1 Accuracy: 0.649631679058075, Current Top 1 PC Accuracy: tensor([0.0571, 1.0000, 0.8000, 0.7426, 0.4638, 0.7500, 0.9720, 0.3473],
       device='cuda:0')
INFO:root:rank 1/iteration 200: Current Top 1 Accuracy: 0.6716417670249939, Current Top 1 PC Accuracy: tensor([0.0843, 0.9367, 0.8446, 0.7715, 0.5000, 0.7668, 0.9644, 0.2941],
       device='cuda:0')
INFO:root:rank 0/iteration 200: Current Top 1 Accuracy: 0.671227216720581, Current Top 1 PC Accuracy: tensor([0.0822, 0.9318, 0.8312, 0.7587, 0.4954, 0.7665, 0.9535, 0.3547],
       device='cuda:0')
INFO:root:rank 2/iteration 200: Current Top 1 Accuracy: 0.6724709868431091, Current Top 1 PC Accuracy: tensor([0.0556, 0.9269, 0.8312, 0.7664, 0.5026, 0.7444, 0.9720, 0.3392],
       device='cuda:0')
INFO:root:rank 1/iteration 220: Current Top 1 Accuracy: 0.6847662329673767, Current Top 1 PC Accuracy: tensor([0.0778, 0.9208, 0.8618, 0.7795, 0.5310, 0.7293, 0.9644, 0.2778],
       device='cuda:0')
INFO:root:rank 0/iteration 220: Current Top 1 Accuracy: 0.6843891143798828, Current Top 1 PC Accuracy: tensor([0.0769, 0.9115, 0.8500, 0.7681, 0.5251, 0.7296, 0.9535, 0.3352],
       device='cuda:0')
INFO:root:rank 2/iteration 220: Current Top 1 Accuracy: 0.6851432919502258, Current Top 1 PC Accuracy: tensor([0.0513, 0.9070, 0.8502, 0.7743, 0.5339, 0.7153, 0.9674, 0.3187],
       device='cuda:0')
INFO:root:rank 1/iteration 240: Current Top 1 Accuracy: 0.7022821307182312, Current Top 1 PC Accuracy: tensor([0.2906, 0.9208, 0.8658, 0.7578, 0.5303, 0.7674, 0.9688, 0.4113],
       device='cuda:0')
INFO:root:rank 0/iteration 240: Current Top 1 Accuracy: 0.7036652565002441, Current Top 1 PC Accuracy: tensor([0.3208, 0.9085, 0.8543, 0.7569, 0.5244, 0.7701, 0.9639, 0.4596],
       device='cuda:0')
INFO:root:rank 2/iteration 240: Current Top 1 Accuracy: 0.7029737234115601, Current Top 1 PC Accuracy: tensor([0.3019, 0.9070, 0.8546, 0.7575, 0.5339, 0.7543, 0.9746, 0.4412],
       device='cuda:0')
INFO:root:rank 1/iteration 260: Current Top 1 Accuracy: 0.7145593762397766, Current Top 1 PC Accuracy: tensor([0.4276, 0.9208, 0.8658, 0.7209, 0.5284, 0.7920, 0.9738, 0.5235],
       device='cuda:0')
INFO:root:rank 0/iteration 260: Current Top 1 Accuracy: 0.7167943716049194, Current Top 1 PC Accuracy: tensor([0.4627, 0.9085, 0.8543, 0.7268, 0.5213, 0.7990, 0.9705, 0.5563],
       device='cuda:0')
INFO:root:rank 2/iteration 260: Current Top 1 Accuracy: 0.7171136736869812, Current Top 1 PC Accuracy: tensor([0.4436, 0.9070, 0.8546, 0.7277, 0.5339, 0.7816, 0.9792, 0.5484],
       device='cuda:0')
INFO:root:rank 1/iteration 280: Current Top 1 Accuracy: 0.7274614572525024, Current Top 1 PC Accuracy: tensor([0.5230, 0.9208, 0.8658, 0.7037, 0.5278, 0.8130, 0.9782, 0.5827],
       device='cuda:0')
INFO:root:rank 0/iteration 280: Current Top 1 Accuracy: 0.7289442420005798, Current Top 1 PC Accuracy: tensor([0.5556, 0.9085, 0.8543, 0.7044, 0.5206, 0.8133, 0.9731, 0.6143],
       device='cuda:0')
INFO:root:rank 2/iteration 280: Current Top 1 Accuracy: 0.7289442420005798, Current Top 1 PC Accuracy: tensor([0.5432, 0.9070, 0.8546, 0.7056, 0.5333, 0.7979, 0.9827, 0.6022],
       device='cuda:0')
INFO:root:rank 1/iteration 300: Current Top 1 Accuracy: 0.7397563457489014, Current Top 1 PC Accuracy: tensor([0.5891, 0.9208, 0.8667, 0.6953, 0.5265, 0.8289, 0.9806, 0.6340],
       device='cuda:0')
INFO:root:rank 0/iteration 300: Current Top 1 Accuracy: 0.7389258146286011, Current Top 1 PC Accuracy: tensor([0.6230, 0.9085, 0.8553, 0.6856, 0.5194, 0.8299, 0.9761, 0.6524],
       device='cuda:0')
INFO:root:rank 2/iteration 300: Current Top 1 Accuracy: 0.738095223903656, Current Top 1 PC Accuracy: tensor([0.6126, 0.9070, 0.8559, 0.6869, 0.5300, 0.8150, 0.9845, 0.6408],
       device='cuda:0')
INFO:root:rank 1/iteration 320: Current Top 1 Accuracy: 0.7468847632408142, Current Top 1 PC Accuracy: tensor([0.5833, 0.8939, 0.8797, 0.7079, 0.5579, 0.8289, 0.9806, 0.6196],
       device='cuda:0')
INFO:root:rank 0/iteration 320: Current Top 1 Accuracy: 0.7458463311195374, Current Top 1 PC Accuracy: tensor([0.6134, 0.8842, 0.8713, 0.6996, 0.5519, 0.8283, 0.9761, 0.6343],
       device='cuda:0')
INFO:root:rank 2/iteration 320: Current Top 1 Accuracy: 0.7437694668769836, Current Top 1 PC Accuracy: tensor([0.6062, 0.8827, 0.8703, 0.6940, 0.5601, 0.8135, 0.9845, 0.6219],
       device='cuda:0')
INFO:root:rank 1/iteration 340: Current Top 1 Accuracy: 0.7514662742614746, Current Top 1 PC Accuracy: tensor([0.5640, 0.8859, 0.8930, 0.7205, 0.5783, 0.8089, 0.9806, 0.6112],
       device='cuda:0')
INFO:root:rank 0/iteration 340: Current Top 1 Accuracy: 0.75, Current Top 1 PC Accuracy: tensor([0.5920, 0.8795, 0.8852, 0.7134, 0.5731, 0.8040, 0.9761, 0.6241],
       device='cuda:0')
INFO:root:rank 2/iteration 340: Current Top 1 Accuracy: 0.7485337257385254, Current Top 1 PC Accuracy: tensor([0.5850, 0.8781, 0.8846, 0.7108, 0.5817, 0.7932, 0.9845, 0.6094],
       device='cuda:0')
INFO:root:rank 1/iteration 360: Current Top 1 Accuracy: 0.7368420958518982, Current Top 1 PC Accuracy: tensor([0.5484, 0.8949, 0.8858, 0.7260, 0.5795, 0.7758, 0.9682, 0.5418],
       device='cuda:0')
INFO:root:rank 0/iteration 360: Current Top 1 Accuracy: 0.7356879115104675, Current Top 1 PC Accuracy: tensor([0.5833, 0.8889, 0.8812, 0.7150, 0.5743, 0.7661, 0.9657, 0.5569],
       device='cuda:0')
INFO:root:rank 2/iteration 360: Current Top 1 Accuracy: 0.7352262139320374, Current Top 1 PC Accuracy: tensor([0.5764, 0.8887, 0.8763, 0.7208, 0.5830, 0.7620, 0.9695, 0.5417],
       device='cuda:0')
INFO:root:rank 1/iteration 380: Current Top 1 Accuracy: 0.7270340919494629, Current Top 1 PC Accuracy: tensor([0.5312, 0.9048, 0.8756, 0.7339, 0.5856, 0.7466, 0.9540, 0.4982],
       device='cuda:0')
INFO:root:rank 0/iteration 380: Current Top 1 Accuracy: 0.7272528409957886, Current Top 1 PC Accuracy: tensor([0.5640, 0.8993, 0.8744, 0.7221, 0.5822, 0.7366, 0.9574, 0.5150],
       device='cuda:0')
INFO:root:rank 2/iteration 380: Current Top 1 Accuracy: 0.7259405255317688, Current Top 1 PC Accuracy: tensor([0.5598, 0.8991, 0.8653, 0.7277, 0.5876, 0.7355, 0.9632, 0.4982],
       device='cuda:0')
INFO:root:rank 1/iteration 400: Current Top 1 Accuracy: 0.7279717326164246, Current Top 1 PC Accuracy: tensor([0.5800, 0.8949, 0.8756, 0.7357, 0.5856, 0.7221, 0.9600, 0.5101],
       device='cuda:0')
INFO:root:rank 0/iteration 400: Current Top 1 Accuracy: 0.7288029789924622, Current Top 1 PC Accuracy: tensor([0.6118, 0.8895, 0.8744, 0.7229, 0.5822, 0.7218, 0.9614, 0.5255],
       device='cuda:0')
INFO:root:rank 2/iteration 400: Current Top 1 Accuracy: 0.727348268032074, Current Top 1 PC Accuracy: tensor([0.6151, 0.8925, 0.8653, 0.7280, 0.5876, 0.7155, 0.9662, 0.5109],
       device='cuda:0')
INFO:root:rank 1/iteration 420: Current Top 1 Accuracy: 0.7325811386108398, Current Top 1 PC Accuracy: tensor([0.6290, 0.8949, 0.8756, 0.7357, 0.5856, 0.7162, 0.9650, 0.5232],
       device='cuda:0')
INFO:root:rank 0/iteration 420: Current Top 1 Accuracy: 0.732977032661438, Current Top 1 PC Accuracy: tensor([0.6567, 0.8879, 0.8744, 0.7218, 0.5822, 0.7170, 0.9662, 0.5382],
       device='cuda:0')
INFO:root:rank 2/iteration 420: Current Top 1 Accuracy: 0.7315914630889893, Current Top 1 PC Accuracy: tensor([0.6567, 0.8893, 0.8653, 0.7269, 0.5876, 0.7132, 0.9704, 0.5245],
       device='cuda:0')
INFO:root:rank 1/iteration 440: Current Top 1 Accuracy: 0.7356386780738831, Current Top 1 PC Accuracy: tensor([0.6809, 0.8901, 0.8756, 0.7345, 0.5856, 0.7060, 0.9684, 0.5335],
       device='cuda:0')
INFO:root:rank 0/iteration 440: Current Top 1 Accuracy: 0.7345049381256104, Current Top 1 PC Accuracy: tensor([0.7051, 0.8799, 0.8744, 0.7207, 0.5822, 0.7022, 0.9695, 0.5441],
       device='cuda:0')
INFO:root:rank 2/iteration 440: Current Top 1 Accuracy: 0.7339380383491516, Current Top 1 PC Accuracy: tensor([0.7051, 0.8829, 0.8653, 0.7269, 0.5876, 0.6996, 0.9734, 0.5328],
       device='cuda:0')
INFO:root:rank 1/iteration 460: Current Top 1 Accuracy: 0.7279465198516846, Current Top 1 PC Accuracy: tensor([0.6899, 0.8937, 0.8674, 0.7282, 0.5847, 0.6959, 0.9614, 0.5061],
       device='cuda:0')
INFO:root:rank 0/iteration 460: Current Top 1 Accuracy: 0.727584958076477, Current Top 1 PC Accuracy: tensor([0.7095, 0.8795, 0.8696, 0.7184, 0.5834, 0.6936, 0.9637, 0.5163],
       device='cuda:0')
INFO:root:rank 2/iteration 460: Current Top 1 Accuracy: 0.7277657389640808, Current Top 1 PC Accuracy: tensor([0.7173, 0.8870, 0.8614, 0.7204, 0.5907, 0.6886, 0.9687, 0.5074],
       device='cuda:0')
INFO:root:rank 1/iteration 480: Current Top 1 Accuracy: 0.7205474972724915, Current Top 1 PC Accuracy: tensor([0.6781, 0.9008, 0.8624, 0.7394, 0.5868, 0.6769, 0.9575, 0.4735],
       device='cuda:0')
INFO:root:rank 0/iteration 480: Current Top 1 Accuracy: 0.7202009558677673, Current Top 1 PC Accuracy: tensor([0.6988, 0.8884, 0.8654, 0.7350, 0.5824, 0.6762, 0.9597, 0.4798],
       device='cuda:0')
INFO:root:rank 2/iteration 480: Current Top 1 Accuracy: 0.7202009558677673, Current Top 1 PC Accuracy: tensor([0.7087, 0.8948, 0.8574, 0.7345, 0.5907, 0.6689, 0.9660, 0.4730],
       device='cuda:0')
INFO:root:rank 1/iteration 500: Current Top 1 Accuracy: 0.7070858478546143, Current Top 1 PC Accuracy: tensor([0.6751, 0.9021, 0.8447, 0.7368, 0.5451, 0.6710, 0.9549, 0.4769],
       device='cuda:0')
INFO:root:rank 0/iteration 500: Current Top 1 Accuracy: 0.7070858478546143, Current Top 1 PC Accuracy: tensor([0.6971, 0.8914, 0.8493, 0.7284, 0.5429, 0.6729, 0.9557, 0.4818],
       device='cuda:0')
INFO:root:rank 2/iteration 500: Current Top 1 Accuracy: 0.706753134727478, Current Top 1 PC Accuracy: tensor([0.7029, 0.8976, 0.8384, 0.7302, 0.5510, 0.6639, 0.9633, 0.4740],
       device='cuda:0')
INFO:root:rank 1/iteration 520: Current Top 1 Accuracy: 0.6949775815010071, Current Top 1 PC Accuracy: tensor([0.6971, 0.8953, 0.8379, 0.7368, 0.5091, 0.6680, 0.9550, 0.4716],
       device='cuda:0')
INFO:root:rank 0/iteration 520: Current Top 1 Accuracy: 0.6951375603675842, Current Top 1 PC Accuracy: tensor([0.7155, 0.8874, 0.8438, 0.7275, 0.5066, 0.6693, 0.9559, 0.4781],
       device='cuda:0')
INFO:root:rank 2/iteration 520: Current Top 1 Accuracy: 0.6951375603675842, Current Top 1 PC Accuracy: tensor([0.7270, 0.8894, 0.8317, 0.7302, 0.5126, 0.6634, 0.9633, 0.4705],
       device='cuda:0')
INFO:root:rank 1/iteration 540: Current Top 1 Accuracy: 0.6903881430625916, Current Top 1 PC Accuracy: tensor([0.6917, 0.9004, 0.8259, 0.7431, 0.4996, 0.6556, 0.9550, 0.4701],
       device='cuda:0')
INFO:root:rank 0/iteration 540: Current Top 1 Accuracy: 0.6905422210693359, Current Top 1 PC Accuracy: tensor([0.7077, 0.8927, 0.8351, 0.7319, 0.4973, 0.6588, 0.9559, 0.4754],
       device='cuda:0')
INFO:root:rank 2/iteration 540: Current Top 1 Accuracy: 0.6911583542823792, Current Top 1 PC Accuracy: tensor([0.7173, 0.8949, 0.8254, 0.7347, 0.5051, 0.6521, 0.9633, 0.4684],
       device='cuda:0')
INFO:root:rank 1/iteration 560: Current Top 1 Accuracy: 0.6898396015167236, Current Top 1 PC Accuracy: tensor([0.6917, 0.8966, 0.8073, 0.7500, 0.5065, 0.6493, 0.9550, 0.4696],
       device='cuda:0')
INFO:root:rank 0/iteration 560: Current Top 1 Accuracy: 0.6904337406158447, Current Top 1 PC Accuracy: tensor([0.7077, 0.8915, 0.8179, 0.7410, 0.5040, 0.6518, 0.9559, 0.4743],
       device='cuda:0')
INFO:root:rank 2/iteration 560: Current Top 1 Accuracy: 0.690582275390625, Current Top 1 PC Accuracy: tensor([0.7173, 0.8907, 0.8036, 0.7427, 0.5133, 0.6460, 0.9633, 0.4674],
       device='cuda:0')
INFO:root:rank 1/iteration 580: Current Top 1 Accuracy: 0.6906196475028992, Current Top 1 PC Accuracy: tensor([0.6899, 0.9016, 0.8000, 0.7618, 0.5110, 0.6431, 0.9550, 0.4637],
       device='cuda:0')
INFO:root:rank 0/iteration 580: Current Top 1 Accuracy: 0.6911933422088623, Current Top 1 PC Accuracy: tensor([0.7077, 0.8959, 0.8099, 0.7520, 0.5079, 0.6449, 0.9559, 0.4695],
       device='cuda:0')
INFO:root:rank 2/iteration 580: Current Top 1 Accuracy: 0.6911933422088623, Current Top 1 PC Accuracy: tensor([0.7154, 0.8942, 0.7993, 0.7533, 0.5162, 0.6388, 0.9633, 0.4636],
       device='cuda:0')
INFO:root:rank 1/iteration 600: Current Top 1 Accuracy: 0.691209077835083, Current Top 1 PC Accuracy: tensor([0.6829, 0.9065, 0.7904, 0.7670, 0.5212, 0.6334, 0.9550, 0.4632],
       device='cuda:0')
INFO:root:rank 0/iteration 600: Current Top 1 Accuracy: 0.691209077835083, Current Top 1 PC Accuracy: tensor([0.7000, 0.9005, 0.8009, 0.7563, 0.5172, 0.6352, 0.9559, 0.4690],
       device='cuda:0')
INFO:root:rank 2/iteration 600: Current Top 1 Accuracy: 0.6913477778434753, Current Top 1 PC Accuracy: tensor([0.7042, 0.8993, 0.7932, 0.7576, 0.5242, 0.6300, 0.9633, 0.4631],
       device='cuda:0')
INFO:root:rank 1/iteration 620: Current Top 1 Accuracy: 0.6921631693840027, Current Top 1 PC Accuracy: tensor([0.6829, 0.9029, 0.7759, 0.7736, 0.5325, 0.6263, 0.9550, 0.4632],
       device='cuda:0')
INFO:root:rank 0/iteration 620: Current Top 1 Accuracy: 0.6913580298423767, Current Top 1 PC Accuracy: tensor([0.6981, 0.8952, 0.7851, 0.7620, 0.5283, 0.6269, 0.9559, 0.4685],
       device='cuda:0')
INFO:root:rank 2/iteration 620: Current Top 1 Accuracy: 0.6922973990440369, Current Top 1 PC Accuracy: tensor([0.7042, 0.8954, 0.7807, 0.7641, 0.5349, 0.6226, 0.9633, 0.4626],
       device='cuda:0')
INFO:root:rank 1/iteration 640: Current Top 1 Accuracy: 0.6820072531700134, Current Top 1 PC Accuracy: tensor([0.6845, 0.9043, 0.7638, 0.7724, 0.5038, 0.6243, 0.9550, 0.4651],
       device='cuda:0')
INFO:root:rank 0/iteration 640: Current Top 1 Accuracy: 0.6823973059654236, Current Top 1 PC Accuracy: tensor([0.7021, 0.8971, 0.7771, 0.7617, 0.5000, 0.6256, 0.9560, 0.4708],
       device='cuda:0')
INFO:root:rank 2/iteration 640: Current Top 1 Accuracy: 0.6817472577095032, Current Top 1 PC Accuracy: tensor([0.7057, 0.8980, 0.7683, 0.7611, 0.5059, 0.6192, 0.9633, 0.4638],
       device='cuda:0')
INFO:root:rank 1/iteration 660: Current Top 1 Accuracy: 0.6712052226066589, Current Top 1 PC Accuracy: tensor([0.6983, 0.9012, 0.7579, 0.7707, 0.4774, 0.6261, 0.9551, 0.4604],
       device='cuda:0')
INFO:root:rank 0/iteration 660: Current Top 1 Accuracy: 0.6714574098587036, Current Top 1 PC Accuracy: tensor([0.7150, 0.8941, 0.7703, 0.7609, 0.4731, 0.6271, 0.9560, 0.4666],
       device='cuda:0')
INFO:root:rank 2/iteration 660: Current Top 1 Accuracy: 0.6705749034881592, Current Top 1 PC Accuracy: tensor([0.7182, 0.8970, 0.7638, 0.7587, 0.4772, 0.6184, 0.9633, 0.4615],
       device='cuda:0')
INFO:root:rank 1/iteration 680: Current Top 1 Accuracy: 0.6718061566352844, Current Top 1 PC Accuracy: tensor([0.7175, 0.8992, 0.7572, 0.7657, 0.4676, 0.6333, 0.9582, 0.4725],
       device='cuda:0')
INFO:root:rank 0/iteration 680: Current Top 1 Accuracy: 0.672173261642456, Current Top 1 PC Accuracy: tensor([0.7321, 0.8931, 0.7695, 0.7561, 0.4634, 0.6358, 0.9592, 0.4775],
       device='cuda:0')
INFO:root:rank 2/iteration 680: Current Top 1 Accuracy: 0.671194314956665, Current Top 1 PC Accuracy: tensor([0.7335, 0.8950, 0.7638, 0.7547, 0.4681, 0.6264, 0.9661, 0.4712],
       device='cuda:0')
INFO:root:rank 1/iteration 700: Current Top 1 Accuracy: 0.6705896258354187, Current Top 1 PC Accuracy: tensor([0.7251, 0.8992, 0.7572, 0.7575, 0.4567, 0.6447, 0.9611, 0.4718],
       device='cuda:0')
INFO:root:rank 0/iteration 700: Current Top 1 Accuracy: 0.6713029146194458, Current Top 1 PC Accuracy: tensor([0.7407, 0.8931, 0.7695, 0.7482, 0.4534, 0.6462, 0.9621, 0.4769],
       device='cuda:0')
INFO:root:rank 2/iteration 700: Current Top 1 Accuracy: 0.6704707741737366, Current Top 1 PC Accuracy: tensor([0.7408, 0.8950, 0.7638, 0.7469, 0.4566, 0.6386, 0.9685, 0.4738],
       device='cuda:0')
INFO:root:rank 1/iteration 720: Current Top 1 Accuracy: 0.6717522144317627, Current Top 1 PC Accuracy: tensor([0.7171, 0.9018, 0.7644, 0.7378, 0.4734, 0.6388, 0.9622, 0.4658],
       device='cuda:0')
INFO:root:rank 0/iteration 720: Current Top 1 Accuracy: 0.6725612282752991, Current Top 1 PC Accuracy: tensor([0.7356, 0.8940, 0.7748, 0.7306, 0.4699, 0.6403, 0.9632, 0.4717],
       device='cuda:0')
INFO:root:rank 2/iteration 720: Current Top 1 Accuracy: 0.6709431409835815, Current Top 1 PC Accuracy: tensor([0.7341, 0.8967, 0.7702, 0.7267, 0.4729, 0.6320, 0.9694, 0.4669],
       device='cuda:0')
INFO:root:rank 1/iteration 740: Current Top 1 Accuracy: 0.6748762726783752, Current Top 1 PC Accuracy: tensor([0.7140, 0.9011, 0.7746, 0.7407, 0.4845, 0.6321, 0.9622, 0.4606],
       device='cuda:0')
INFO:root:rank 0/iteration 740: Current Top 1 Accuracy: 0.6752136945724487, Current Top 1 PC Accuracy: tensor([0.7356, 0.8930, 0.7843, 0.7301, 0.4803, 0.6355, 0.9632, 0.4651],
       device='cuda:0')
INFO:root:rank 2/iteration 740: Current Top 1 Accuracy: 0.6745389103889465, Current Top 1 PC Accuracy: tensor([0.7341, 0.8963, 0.7798, 0.7304, 0.4839, 0.6288, 0.9694, 0.4603],
       device='cuda:0')
INFO:root:rank 1/iteration 760: Current Top 1 Accuracy: 0.6769601106643677, Current Top 1 PC Accuracy: tensor([0.7063, 0.9054, 0.7809, 0.7283, 0.5029, 0.6279, 0.9622, 0.4539],
       device='cuda:0')
INFO:root:rank 0/iteration 760: Current Top 1 Accuracy: 0.6779456734657288, Current Top 1 PC Accuracy: tensor([0.7323, 0.8979, 0.7904, 0.7202, 0.4993, 0.6322, 0.9632, 0.4575],
       device='cuda:0')
INFO:root:rank 2/iteration 760: Current Top 1 Accuracy: 0.6767411231994629, Current Top 1 PC Accuracy: tensor([0.7291, 0.9009, 0.7863, 0.7183, 0.5024, 0.6256, 0.9694, 0.4523],
       device='cuda:0')
INFO:root:rank 1/iteration 780: Current Top 1 Accuracy: 0.6778702735900879, Current Top 1 PC Accuracy: tensor([0.7047, 0.9032, 0.7890, 0.7236, 0.5113, 0.6200, 0.9622, 0.4490],
       device='cuda:0')
INFO:root:rank 0/iteration 780: Current Top 1 Accuracy: 0.6786171793937683, Current Top 1 PC Accuracy: tensor([0.7323, 0.8960, 0.7983, 0.7133, 0.5082, 0.6239, 0.9621, 0.4525],
       device='cuda:0')
INFO:root:rank 2/iteration 780: Current Top 1 Accuracy: 0.6777635216712952, Current Top 1 PC Accuracy: tensor([0.7291, 0.8959, 0.7932, 0.7161, 0.5109, 0.6180, 0.9682, 0.4478],
       device='cuda:0')
INFO:root:rank 1/iteration 800: Current Top 1 Accuracy: 0.680295467376709, Current Top 1 PC Accuracy: tensor([0.7104, 0.9044, 0.7890, 0.7181, 0.5097, 0.6292, 0.9649, 0.4589],
       device='cuda:0')
INFO:root:rank 0/iteration 800: Current Top 1 Accuracy: 0.6812317967414856, Current Top 1 PC Accuracy: tensor([0.7394, 0.8971, 0.7983, 0.7074, 0.5060, 0.6340, 0.9648, 0.4635],
       device='cuda:0')
INFO:root:rank 2/iteration 800: Current Top 1 Accuracy: 0.6807116270065308, Current Top 1 PC Accuracy: tensor([0.7357, 0.8972, 0.7932, 0.7113, 0.5086, 0.6284, 0.9706, 0.4588],
       device='cuda:0')
INFO:root:rank 1/iteration 820: Current Top 1 Accuracy: 0.6799430847167969, Current Top 1 PC Accuracy: tensor([0.7210, 0.9044, 0.7890, 0.7115, 0.5016, 0.6372, 0.9673, 0.4595],
       device='cuda:0')
INFO:root:rank 1/iteration 820: Current Top 1 Accuracy: 0.6799430847167969, Current Top 1 PC Accuracy: tensor([0.7210, 0.9044, 0.7890, 0.7115, 0.5016, 0.6372, 0.9673, 0.4595],
       device='cuda:0')
[rank1]:[W1115 16:53:01.786898525 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 0/iteration 820: Current Top 1 Accuracy: 0.6810607314109802, Current Top 1 PC Accuracy: tensor([0.7505, 0.8971, 0.7983, 0.7011, 0.4971, 0.6434, 0.9672, 0.4637],
       device='cuda:0')
INFO:root:rank 0/iteration 820: Current Top 1 Accuracy: 0.6810607314109802, Current Top 1 PC Accuracy: tensor([0.7505, 0.8971, 0.7983, 0.7011, 0.4971, 0.6434, 0.9672, 0.4637],
       device='cuda:0')
[rank0]:[W1115 16:53:07.199965191 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 2/iteration 820: Current Top 1 Accuracy: 0.6799430847167969, Current Top 1 PC Accuracy: tensor([0.7441, 0.8972, 0.7932, 0.7044, 0.5002, 0.6350, 0.9726, 0.4594],
       device='cuda:0')
INFO:root:rank 2/iteration 820: Current Top 1 Accuracy: 0.6799430847167969, Current Top 1 PC Accuracy: tensor([0.7441, 0.8972, 0.7932, 0.7044, 0.5002, 0.6350, 0.9726, 0.4594],
       device='cuda:0')
[rank2]:[W1115 16:53:10.186284917 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:called-params /mnt/slurm/lennart/jepaslt/configs/evals/vith16_384_ravdess_split_4_pretrained_full_video.yaml
INFO:root:loaded params...
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/4_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_4'},
    'tag': 'ravdess_4-16x8x3',
    'tasks_per_node': 3}
INFO:root:Running... (rank: 0/3)
INFO:root:Running evaluation: pretrained_full_video_classification
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/4_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_4'},
    'tag': 'ravdess_4-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 1/3
{   'data': {   'dataset_val': '/mnt/datasets/RAVDESS/additional/splits/4_val.csv',
                'frame_step': 4,
                'frames_per_clip': 16,
                'num_classes': 8},
    'eval_name': 'pretrained_full_video_classification',
    'nodes': 1,
    'optimization': {   'attend_across_segments': True,
                        'batch_size': 12,
                        'resolution': 384},
    'pretrain': {   'checkpoint': 'vith16-384.pth.tar',
                    'checkpoint_key': 'target_encoder',
                    'folder': '/mnt/slurm/lennart/jepaslt/models',
                    'frames_per_clip': 16,
                    'model_name': 'vit_huge',
                    'patch_size': 16,
                    'tight_silu': False,
                    'tubelet_size': 2,
                    'uniform_power': True,
                    'use_sdpa': True,
                    'use_silu': False,
                    'write_tag': 'jepaslt_ravdess_4'},
    'tag': 'ravdess_4-16x8x3',
    'tasks_per_node': 3}
INFO:root:Initialized (rank/world-size) 2/3
INFO:root:Initialized (rank/world-size) 0/3
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:Loading pretrained model from /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:295: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(pretrained, map_location='cpu')
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained model with msg: <All keys matched successfully>
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:loaded pretrained encoder from epoch: 300
 path: /mnt/slurm/lennart/jepaslt/models/vith16-384.pth.tar
INFO:root:Indexed a total number of 480 videos containing 21751 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 605
INFO:root:Indexed a total number of 480 videos containing 21751 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 605
INFO:root:Indexed a total number of 480 videos containing 21751 samples.
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 12 worker processes in total. Our suggested max number of worker in current system is 10, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
INFO:root:Dataloader created... iterations per epoch: 605
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:275: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(r_path, map_location=torch.device('cpu'))
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
INFO:root:loaded pretrained classifier from epoch 20 with msg: <All keys matched successfully>
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/slurm/lennart/jepaslt/evals/pretrained_full_video_classification/eval.py:218: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=torch.float16, enabled=True):
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
/mnt/data/miniforge3/envs/jepaslt/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
INFO:root:rank 0/iteration 0: Current Top 1 Accuracy: 0.9166666865348816, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, 0., nan, 1.], device='cuda:0')
INFO:root:rank 2/iteration 0: Current Top 1 Accuracy: 1.0, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, nan, nan, 1.], device='cuda:0')
INFO:root:rank 1/iteration 0: Current Top 1 Accuracy: 0.9166666865348816, Current Top 1 PC Accuracy: tensor([nan, nan, nan, nan, nan, 0., nan, 1.], device='cuda:0')
INFO:root:rank 0/iteration 20: Current Top 1 Accuracy: 0.7222222089767456, Current Top 1 PC Accuracy: tensor([   nan, 0.0000,    nan, 0.0000,    nan, 0.7373, 1.0000, 0.9167],
       device='cuda:0')
INFO:root:rank 2/iteration 20: Current Top 1 Accuracy: 0.7063491940498352, Current Top 1 PC Accuracy: tensor([   nan, 0.0000,    nan, 0.0000,    nan, 0.7281, 1.0000, 0.9091],
       device='cuda:0')
INFO:root:rank 1/iteration 20: Current Top 1 Accuracy: 0.7103174328804016, Current Top 1 PC Accuracy: tensor([   nan, 0.0000,    nan, 0.0000,    nan, 0.7368, 1.0000, 0.8696],
       device='cuda:0')
INFO:root:rank 2/iteration 40: Current Top 1 Accuracy: 0.7296748161315918, Current Top 1 PC Accuracy: tensor([   nan, 0.3725, 1.0000, 0.0000,    nan, 0.6667, 1.0000, 0.9167],
       device='cuda:0')
INFO:root:rank 1/iteration 40: Current Top 1 Accuracy: 0.7418699264526367, Current Top 1 PC Accuracy: tensor([   nan, 0.3725, 1.0000, 0.0000,    nan, 0.6748, 1.0000, 0.8868],
       device='cuda:0')
INFO:root:rank 0/iteration 40: Current Top 1 Accuracy: 0.7317073345184326, Current Top 1 PC Accuracy: tensor([   nan, 0.3462, 1.0000, 0.0000,    nan, 0.6762, 1.0000, 0.8364],
       device='cuda:0')
INFO:root:rank 2/iteration 60: Current Top 1 Accuracy: 0.7008196711540222, Current Top 1 PC Accuracy: tensor([   nan, 0.6055, 1.0000, 0.6250, 1.0000, 0.5412, 0.9484, 0.6769],
       device='cuda:0')
INFO:root:rank 0/iteration 60: Current Top 1 Accuracy: 0.7035518884658813, Current Top 1 PC Accuracy: tensor([   nan, 0.5804, 1.0000, 0.6620, 1.0000, 0.5547, 0.9470, 0.6571],
       device='cuda:0')
INFO:root:rank 1/iteration 60: Current Top 1 Accuracy: 0.7103825211524963, Current Top 1 PC Accuracy: tensor([   nan, 0.5856, 1.0000, 0.6757, 1.0000, 0.5538, 0.9371, 0.7015],
       device='cuda:0')
INFO:root:rank 2/iteration 80: Current Top 1 Accuracy: 0.6893004179000854, Current Top 1 PC Accuracy: tensor([   nan, 0.7238, 1.0000, 0.7236, 1.0000, 0.4726, 0.8596, 0.5238],
       device='cuda:0')
INFO:root:rank 0/iteration 80: Current Top 1 Accuracy: 0.6841563582420349, Current Top 1 PC Accuracy: tensor([   nan, 0.7033, 1.0000, 0.7458, 1.0000, 0.4846, 0.8412, 0.5055],
       device='cuda:0')
INFO:root:rank 1/iteration 80: Current Top 1 Accuracy: 0.6923868060112, Current Top 1 PC Accuracy: tensor([   nan, 0.6995, 1.0000, 0.7563, 1.0000, 0.4826, 0.8466, 0.5465],
       device='cuda:0')
INFO:root:rank 2/iteration 100: Current Top 1 Accuracy: 0.6757425665855408, Current Top 1 PC Accuracy: tensor([   nan, 0.7538, 1.0000, 0.7547, 1.0000, 0.3954, 0.8305, 0.4731],
       device='cuda:0')
INFO:root:rank 1/iteration 100: Current Top 1 Accuracy: 0.6782178282737732, Current Top 1 PC Accuracy: tensor([   nan, 0.7433, 1.0000, 0.7792, 1.0000, 0.4064, 0.8232, 0.4653],
       device='cuda:0')
INFO:root:rank 0/iteration 100: Current Top 1 Accuracy: 0.6773927211761475, Current Top 1 PC Accuracy: tensor([   nan, 0.7539, 1.0000, 0.7677, 1.0000, 0.4069, 0.8125, 0.4694],
       device='cuda:0')
INFO:root:rank 0/iteration 120: Current Top 1 Accuracy: 0.6756198406219482, Current Top 1 PC Accuracy: tensor([   nan, 0.7670, 1.0000, 0.8230, 1.0000, 0.3708, 0.7526, 0.3833],
       device='cuda:0')
INFO:root:rank 2/iteration 120: Current Top 1 Accuracy: 0.6742424368858337, Current Top 1 PC Accuracy: tensor([   nan, 0.7702, 1.0000, 0.8136, 1.0000, 0.3613, 0.7819, 0.3667],
       device='cuda:0')
INFO:root:rank 1/iteration 120: Current Top 1 Accuracy: 0.6804407835006714, Current Top 1 PC Accuracy: tensor([   nan, 0.7596, 1.0000, 0.8404, 1.0000, 0.3737, 0.7680, 0.3790],
       device='cuda:0')
INFO:root:rank 2/iteration 140: Current Top 1 Accuracy: 0.6773049831390381, Current Top 1 PC Accuracy: tensor([   nan, 0.7507, 1.0000, 0.7627, 1.0000, 0.3906, 0.8441, 0.4476],
       device='cuda:0')
INFO:root:rank 1/iteration 140: Current Top 1 Accuracy: 0.682624101638794, Current Top 1 PC Accuracy: tensor([   nan, 0.7385, 1.0000, 0.7904, 1.0000, 0.4039, 0.8315, 0.4595],
       device='cuda:0')
INFO:root:rank 0/iteration 140: Current Top 1 Accuracy: 0.6784870028495789, Current Top 1 PC Accuracy: tensor([   nan, 0.7435, 1.0000, 0.7768, 1.0000, 0.3961, 0.8220, 0.4722],
       device='cuda:0')
INFO:root:rank 2/iteration 160: Current Top 1 Accuracy: 0.6909937858581543, Current Top 1 PC Accuracy: tensor([   nan, 0.7194, 1.0000, 0.7229, 1.0000, 0.4743, 0.8761, 0.5325],
       device='cuda:0')
INFO:root:rank 1/iteration 160: Current Top 1 Accuracy: 0.6977225542068481, Current Top 1 PC Accuracy: tensor([   nan, 0.7080, 1.0000, 0.7637, 1.0000, 0.4896, 0.8661, 0.5337],
       device='cuda:0')
INFO:root:rank 0/iteration 160: Current Top 1 Accuracy: 0.6904761791229248, Current Top 1 PC Accuracy: tensor([   nan, 0.7127, 1.0000, 0.7404, 1.0000, 0.4779, 0.8576, 0.5380],
       device='cuda:0')
INFO:root:rank 2/iteration 180: Current Top 1 Accuracy: 0.6887661218643188, Current Top 1 PC Accuracy: tensor([0.9667, 0.7175, 0.9881, 0.6164, 0.9865, 0.4977, 0.8812, 0.5663],
       device='cuda:0')
INFO:root:rank 1/iteration 180: Current Top 1 Accuracy: 0.6956722140312195, Current Top 1 PC Accuracy: tensor([0.9355, 0.7060, 0.9827, 0.6534, 1.0000, 0.5101, 0.8802, 0.5610],
       device='cuda:0')
INFO:root:rank 0/iteration 180: Current Top 1 Accuracy: 0.6919889450073242, Current Top 1 PC Accuracy: tensor([1.0000, 0.7107, 0.9891, 0.6304, 1.0000, 0.5031, 0.8731, 0.5743],
       device='cuda:0')
INFO:root:rank 2/iteration 200: Current Top 1 Accuracy: 0.6840795874595642, Current Top 1 PC Accuracy: tensor([0.9623, 0.7188, 0.9881, 0.5502, 0.9630, 0.4950, 0.8901, 0.5845],
       device='cuda:0')
INFO:root:rank 1/iteration 200: Current Top 1 Accuracy: 0.690713107585907, Current Top 1 PC Accuracy: tensor([0.9643, 0.7173, 0.9827, 0.5759, 0.9872, 0.5057, 0.8891, 0.5677],
       device='cuda:0')
INFO:root:rank 0/iteration 200: Current Top 1 Accuracy: 0.686981737613678, Current Top 1 PC Accuracy: tensor([1.0000, 0.7135, 0.9838, 0.5469, 0.9859, 0.5007, 0.8825, 0.6044],
       device='cuda:0')
INFO:root:rank 2/iteration 220: Current Top 1 Accuracy: 0.6945701241493225, Current Top 1 PC Accuracy: tensor([0.8947, 0.7419, 0.9871, 0.6108, 0.9730, 0.4840, 0.8627, 0.5689],
       device='cuda:0')
INFO:root:rank 1/iteration 220: Current Top 1 Accuracy: 0.6987179517745972, Current Top 1 PC Accuracy: tensor([0.8438, 0.7430, 0.9872, 0.6324, 0.9907, 0.4903, 0.8656, 0.5532],
       device='cuda:0')
INFO:root:rank 0/iteration 220: Current Top 1 Accuracy: 0.6990950107574463, Current Top 1 PC Accuracy: tensor([0.9310, 0.7401, 0.9880, 0.6117, 0.9904, 0.4889, 0.8586, 0.5887],
       device='cuda:0')
INFO:root:rank 2/iteration 240: Current Top 1 Accuracy: 0.7105808854103088, Current Top 1 PC Accuracy: tensor([0.8500, 0.7735, 0.9725, 0.6446, 0.9817, 0.4814, 0.8454, 0.5689],
       device='cuda:0')
INFO:root:rank 1/iteration 240: Current Top 1 Accuracy: 0.7136929631233215, Current Top 1 PC Accuracy: tensor([0.8060, 0.7751, 0.9793, 0.6603, 0.9938, 0.4856, 0.8500, 0.5532],
       device='cuda:0')
INFO:root:rank 0/iteration 240: Current Top 1 Accuracy: 0.7136929631233215, Current Top 1 PC Accuracy: tensor([0.8852, 0.7692, 0.9773, 0.6417, 0.9935, 0.4856, 0.8429, 0.5887],
       device='cuda:0')
INFO:root:rank 2/iteration 260: Current Top 1 Accuracy: 0.7167943716049194, Current Top 1 PC Accuracy: tensor([0.8095, 0.7963, 0.9764, 0.6700, 0.9852, 0.4704, 0.8112, 0.5639],
       device='cuda:0')
INFO:root:rank 1/iteration 260: Current Top 1 Accuracy: 0.7158365249633789, Current Top 1 PC Accuracy: tensor([0.7606, 0.7941, 0.9761, 0.6736, 0.9950, 0.4745, 0.8205, 0.5394],
       device='cuda:0')
INFO:root:rank 0/iteration 260: Current Top 1 Accuracy: 0.7167943716049194, Current Top 1 PC Accuracy: tensor([0.8308, 0.7909, 0.9802, 0.6611, 0.9948, 0.4719, 0.8114, 0.5763],
       device='cuda:0')
INFO:root:rank 2/iteration 280: Current Top 1 Accuracy: 0.7265717387199402, Current Top 1 PC Accuracy: tensor([0.7846, 0.8092, 0.9755, 0.6944, 0.9879, 0.4610, 0.7989, 0.5614],
       device='cuda:0')
INFO:root:rank 1/iteration 280: Current Top 1 Accuracy: 0.725978672504425, Current Top 1 PC Accuracy: tensor([0.7200, 0.8072, 0.9754, 0.6981, 0.9958, 0.4695, 0.8034, 0.5372],
       device='cuda:0')
INFO:root:rank 0/iteration 280: Current Top 1 Accuracy: 0.7280545830726624, Current Top 1 PC Accuracy: tensor([0.7826, 0.8054, 0.9789, 0.6903, 0.9958, 0.4663, 0.7958, 0.5738],
       device='cuda:0')
INFO:root:rank 2/iteration 300: Current Top 1 Accuracy: 0.7245293259620667, Current Top 1 PC Accuracy: tensor([0.8295, 0.8130, 0.9660, 0.6443, 0.9844, 0.4760, 0.8179, 0.5906],
       device='cuda:0')
INFO:root:rank 1/iteration 300: Current Top 1 Accuracy: 0.7270210385322571, Current Top 1 PC Accuracy: tensor([0.7624, 0.8100, 0.9683, 0.6591, 0.9960, 0.4871, 0.8241, 0.5693],
       device='cuda:0')
INFO:root:rank 0/iteration 300: Current Top 1 Accuracy: 0.7292358875274658, Current Top 1 PC Accuracy: tensor([0.8191, 0.8093, 0.9721, 0.6457, 0.9919, 0.4853, 0.8197, 0.6054],
       device='cuda:0')
INFO:root:rank 2/iteration 320: Current Top 1 Accuracy: 0.7149532437324524, Current Top 1 PC Accuracy: tensor([0.8707, 0.8090, 0.9590, 0.5972, 0.9806, 0.4761, 0.8243, 0.5985],
       device='cuda:0')
INFO:root:rank 1/iteration 320: Current Top 1 Accuracy: 0.7183281183242798, Current Top 1 PC Accuracy: tensor([0.8195, 0.8073, 0.9636, 0.6042, 0.9880, 0.4869, 0.8326, 0.5854],
       device='cuda:0')
INFO:root:rank 0/iteration 320: Current Top 1 Accuracy: 0.7214434146881104, Current Top 1 PC Accuracy: tensor([0.8651, 0.8066, 0.9676, 0.5958, 0.9879, 0.4864, 0.8288, 0.6214],
       device='cuda:0')
INFO:root:rank 2/iteration 340: Current Top 1 Accuracy: 0.7060117125511169, Current Top 1 PC Accuracy: tensor([0.8921, 0.8023, 0.9590, 0.5655, 0.9656, 0.5005, 0.7762, 0.6213],
       device='cuda:0')
INFO:root:rank 1/iteration 340: Current Top 1 Accuracy: 0.7082111239433289, Current Top 1 PC Accuracy: tensor([0.8462, 0.8046, 0.9636, 0.5644, 0.9802, 0.5109, 0.7814, 0.6076],
       device='cuda:0')
INFO:root:rank 0/iteration 340: Current Top 1 Accuracy: 0.7118768095970154, Current Top 1 PC Accuracy: tensor([0.8882, 0.8013, 0.9676, 0.5615, 0.9722, 0.5097, 0.7778, 0.6438],
       device='cuda:0')
INFO:root:rank 2/iteration 360: Current Top 1 Accuracy: 0.7142197489738464, Current Top 1 PC Accuracy: tensor([0.8973, 0.8151, 0.9608, 0.5808, 0.9698, 0.5111, 0.7561, 0.6213],
       device='cuda:0')
INFO:root:rank 1/iteration 360: Current Top 1 Accuracy: 0.7153739333152771, Current Top 1 PC Accuracy: tensor([0.8519, 0.8148, 0.9627, 0.5783, 0.9826, 0.5213, 0.7617, 0.6076],
       device='cuda:0')
INFO:root:rank 0/iteration 360: Current Top 1 Accuracy: 0.719067394733429, Current Top 1 PC Accuracy: tensor([0.8924, 0.8144, 0.9665, 0.5741, 0.9756, 0.5201, 0.7587, 0.6438],
       device='cuda:0')
INFO:root:rank 2/iteration 380: Current Top 1 Accuracy: 0.7209098935127258, Current Top 1 PC Accuracy: tensor([0.8973, 0.8179, 0.9626, 0.5946, 0.9757, 0.5111, 0.7354, 0.6151],
       device='cuda:0')
INFO:root:rank 1/iteration 380: Current Top 1 Accuracy: 0.7233158349990845, Current Top 1 PC Accuracy: tensor([0.8519, 0.8195, 0.9625, 0.5949, 0.9863, 0.5213, 0.7425, 0.6057],
       device='cuda:0')
INFO:root:rank 0/iteration 380: Current Top 1 Accuracy: 0.7272528409957886, Current Top 1 PC Accuracy: tensor([0.8924, 0.8205, 0.9642, 0.5905, 0.9807, 0.5201, 0.7439, 0.6396],
       device='cuda:0')
INFO:root:rank 2/iteration 400: Current Top 1 Accuracy: 0.7246466875076294, Current Top 1 PC Accuracy: tensor([0.8973, 0.8119, 0.9604, 0.6120, 0.9788, 0.5111, 0.7174, 0.6131],
       device='cuda:0')
INFO:root:rank 1/iteration 400: Current Top 1 Accuracy: 0.7281795740127563, Current Top 1 PC Accuracy: tensor([0.8519, 0.8151, 0.9605, 0.6131, 0.9882, 0.5213, 0.7260, 0.6057],
       device='cuda:0')
INFO:root:rank 0/iteration 400: Current Top 1 Accuracy: 0.7315045595169067, Current Top 1 PC Accuracy: tensor([0.8924, 0.8142, 0.9638, 0.6081, 0.9833, 0.5201, 0.7262, 0.6396],
       device='cuda:0')
INFO:root:rank 2/iteration 420: Current Top 1 Accuracy: 0.7323831915855408, Current Top 1 PC Accuracy: tensor([0.8973, 0.8187, 0.9625, 0.6249, 0.9811, 0.5111, 0.7125, 0.6071],
       device='cuda:0')
INFO:root:rank 1/iteration 420: Current Top 1 Accuracy: 0.7349564433097839, Current Top 1 PC Accuracy: tensor([0.8519, 0.8190, 0.9641, 0.6243, 0.9895, 0.5202, 0.7209, 0.6000],
       device='cuda:0')
INFO:root:rank 0/iteration 420: Current Top 1 Accuracy: 0.7387173175811768, Current Top 1 PC Accuracy: tensor([0.8924, 0.8189, 0.9669, 0.6208, 0.9852, 0.5201, 0.7185, 0.6375],
       device='cuda:0')
INFO:root:rank 2/iteration 440: Current Top 1 Accuracy: 0.7250567078590393, Current Top 1 PC Accuracy: tensor([0.9085, 0.8207, 0.9608, 0.5967, 0.9758, 0.5222, 0.6849, 0.6142],
       device='cuda:0')
INFO:root:rank 1/iteration 440: Current Top 1 Accuracy: 0.7278911471366882, Current Top 1 PC Accuracy: tensor([0.8659, 0.8199, 0.9654, 0.5980, 0.9838, 0.5306, 0.6911, 0.6101],
       device='cuda:0')
INFO:root:rank 0/iteration 440: Current Top 1 Accuracy: 0.7307256460189819, Current Top 1 PC Accuracy: tensor([0.9029, 0.8198, 0.9652, 0.5902, 0.9778, 0.5298, 0.6927, 0.6451],
       device='cuda:0')
INFO:root:rank 2/iteration 460: Current Top 1 Accuracy: 0.7252349853515625, Current Top 1 PC Accuracy: tensor([0.9202, 0.8207, 0.9608, 0.5858, 0.9758, 0.5522, 0.6799, 0.6194],
       device='cuda:0')
INFO:root:rank 1/iteration 460: Current Top 1 Accuracy: 0.7281272411346436, Current Top 1 PC Accuracy: tensor([0.8835, 0.8180, 0.9654, 0.5901, 0.9818, 0.5580, 0.6857, 0.6156],
       device='cuda:0')
INFO:root:rank 0/iteration 460: Current Top 1 Accuracy: 0.7304772138595581, Current Top 1 PC Accuracy: tensor([0.9146, 0.8198, 0.9652, 0.5818, 0.9778, 0.5572, 0.6860, 0.6435],
       device='cuda:0')
INFO:root:rank 2/iteration 480: Current Top 1 Accuracy: 0.7338877320289612, Current Top 1 PC Accuracy: tensor([0.9209, 0.8207, 0.9608, 0.5851, 0.9758, 0.5696, 0.7027, 0.6682],
       device='cuda:0')
INFO:root:rank 1/iteration 480: Current Top 1 Accuracy: 0.7371794581413269, Current Top 1 PC Accuracy: tensor([0.8913, 0.8180, 0.9654, 0.5895, 0.9818, 0.5762, 0.7092, 0.6652],
       device='cuda:0')
INFO:root:rank 0/iteration 480: Current Top 1 Accuracy: 0.7389119863510132, Current Top 1 PC Accuracy: tensor([0.9193, 0.8188, 0.9652, 0.5818, 0.9699, 0.5736, 0.7100, 0.6914],
       device='cuda:0')
INFO:root:rank 2/iteration 500: Current Top 1 Accuracy: 0.7378576397895813, Current Top 1 PC Accuracy: tensor([0.9048, 0.8241, 0.9492, 0.5994, 0.9746, 0.5771, 0.7118, 0.6543],
       device='cuda:0')
INFO:root:rank 1/iteration 500: Current Top 1 Accuracy: 0.7406852841377258, Current Top 1 PC Accuracy: tensor([0.8780, 0.8212, 0.9507, 0.6027, 0.9804, 0.5844, 0.7180, 0.6513],
       device='cuda:0')
INFO:root:rank 0/iteration 500: Current Top 1 Accuracy: 0.7411842942237854, Current Top 1 PC Accuracy: tensor([0.9000, 0.8194, 0.9522, 0.5953, 0.9670, 0.5810, 0.7189, 0.6680],
       device='cuda:0')
INFO:root:rank 2/iteration 520: Current Top 1 Accuracy: 0.7349647879600525, Current Top 1 PC Accuracy: tensor([0.8101, 0.8353, 0.9303, 0.6138, 0.9745, 0.5756, 0.7118, 0.6115],
       device='cuda:0')
INFO:root:rank 1/iteration 520: Current Top 1 Accuracy: 0.7381637692451477, Current Top 1 PC Accuracy: tensor([0.7941, 0.8321, 0.9283, 0.6180, 0.9818, 0.5823, 0.7180, 0.6155],
       device='cuda:0')
INFO:root:rank 0/iteration 520: Current Top 1 Accuracy: 0.7384836673736572, Current Top 1 PC Accuracy: tensor([0.7970, 0.8316, 0.9349, 0.6106, 0.9690, 0.5789, 0.7189, 0.6306],
       device='cuda:0')
INFO:root:rank 2/iteration 540: Current Top 1 Accuracy: 0.7367529273033142, Current Top 1 PC Accuracy: tensor([0.7600, 0.8404, 0.9221, 0.6384, 0.9756, 0.5745, 0.7118, 0.5900],
       device='cuda:0')
INFO:root:rank 1/iteration 540: Current Top 1 Accuracy: 0.739833652973175, Current Top 1 PC Accuracy: tensor([0.7526, 0.8378, 0.9204, 0.6428, 0.9825, 0.5801, 0.7180, 0.5941],
       device='cuda:0')
INFO:root:rank 0/iteration 540: Current Top 1 Accuracy: 0.7402957677841187, Current Top 1 PC Accuracy: tensor([0.7606, 0.8359, 0.9277, 0.6346, 0.9705, 0.5773, 0.7189, 0.6071],
       device='cuda:0')
INFO:root:rank 2/iteration 560: Current Top 1 Accuracy: 0.7318776249885559, Current Top 1 PC Accuracy: tensor([0.6614, 0.8473, 0.9076, 0.6482, 0.9767, 0.5719, 0.7118, 0.5559],
       device='cuda:0')
INFO:root:rank 1/iteration 560: Current Top 1 Accuracy: 0.7348484992980957, Current Top 1 PC Accuracy: tensor([0.6565, 0.8451, 0.9053, 0.6513, 0.9801, 0.5786, 0.7180, 0.5623],
       device='cuda:0')
INFO:root:rank 0/iteration 560: Current Top 1 Accuracy: 0.7361853718757629, Current Top 1 PC Accuracy: tensor([0.6729, 0.8428, 0.9131, 0.6454, 0.9720, 0.5757, 0.7189, 0.5719],
       device='cuda:0')
INFO:root:rank 2/iteration 580: Current Top 1 Accuracy: 0.7372346520423889, Current Top 1 PC Accuracy: tensor([0.6735, 0.8522, 0.9102, 0.6569, 0.9772, 0.5840, 0.7199, 0.5550],
       device='cuda:0')
INFO:root:rank 1/iteration 580: Current Top 1 Accuracy: 0.7403901219367981, Current Top 1 PC Accuracy: tensor([0.6705, 0.8491, 0.9081, 0.6601, 0.9790, 0.5898, 0.7261, 0.5629],
       device='cuda:0')
INFO:root:rank 0/iteration 580: Current Top 1 Accuracy: 0.7413941621780396, Current Top 1 PC Accuracy: tensor([0.6830, 0.8469, 0.9156, 0.6544, 0.9727, 0.5871, 0.7274, 0.5700],
       device='cuda:0')
INFO:root:rank 2/iteration 600: Current Top 1 Accuracy: 0.7433444261550903, Current Top 1 PC Accuracy: tensor([0.6835, 0.8514, 0.9102, 0.6564, 0.9740, 0.6020, 0.7385, 0.5892],
       device='cuda:0')
INFO:root:rank 1/iteration 600: Current Top 1 Accuracy: 0.7459789514541626, Current Top 1 PC Accuracy: tensor([0.6846, 0.8491, 0.9081, 0.6595, 0.9728, 0.6066, 0.7435, 0.5943],
       device='cuda:0')
INFO:root:rank 2/iteration 604: Current Top 1 Accuracy: 0.7447248697280884, Current Top 1 PC Accuracy: tensor([0.6913, 0.8514, 0.9102, 0.6564, 0.9740, 0.6020, 0.7420, 0.5966],
       device='cuda:0')
INFO:root:rank 0/iteration 600: Current Top 1 Accuracy: 0.7472268342971802, Current Top 1 PC Accuracy: tensor([0.6959, 0.8469, 0.9156, 0.6526, 0.9696, 0.6035, 0.7456, 0.6029],
       device='cuda:0')
INFO:root:rank 1/iteration 604: Current Top 1 Accuracy: 0.7473452091217041, Current Top 1 PC Accuracy: tensor([0.6921, 0.8491, 0.9081, 0.6595, 0.9728, 0.6066, 0.7469, 0.6017],
       device='cuda:0')
[rank2]:[W1115 17:11:52.782896072 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[rank1]:[W1115 17:11:52.177702304 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
INFO:root:rank 0/iteration 604: Current Top 1 Accuracy: 0.7485864162445068, Current Top 1 PC Accuracy: tensor([0.7032, 0.8469, 0.9156, 0.6526, 0.9696, 0.6035, 0.7492, 0.6096],
       device='cuda:0')
[rank0]:[W1115 17:11:58.708603539 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
